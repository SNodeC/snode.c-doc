<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SNode.C: Simple Node in C++ (SNode.C)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SNode.C
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Simple Node in C++ (SNode.C) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p align="center"><a class="anchor" id="md__2home_2voc_2projects_2snodec_2snode_8c_2README"></a></p>
<p><img src="./docs/assets/README/Logo-All-Horizontal.png" alt="" style="width: 70%;" class="inline"/></p>
<p><a href="https://snodec.github.io/snode.c-doc/html/index.html">(API documentation)</a> is a very simple to use, lightweight, highly extensible, event driven, layer-based framework for network applications in the spirit of node.js written entirely in C++.</p>
<p>The development of the framework began during the summer semester 2020 as part of the course <em>Network and Distributed Systems</em> in the master's program <a href="https://www.fh-ooe.at/en/hagenberg-campus/studiengaenge/master/interactive-media/">Interactive Media</a> at the department <a href="https://www.fh-ooe.at/en/campus-hagenberg/">Informatics, Communications and Media</a> at the <a href="https://www.fh-ooe.at/en/campus-hagenberg/">University of Applied Sciences Upper Austria, Campus Hagenberg</a>, to give students an insight into the fundamental techniques of network and web frameworks.</p>
<p>Main focus (but not only) of the framework is on <em>Machine to Machine</em> (M2M) communication and in particular on the field of <em>Internet of Things</em> (IoT). As such, the SNode.C reference project <a href="https://github.com/SNodeC/mqttsuite">MQTTSuite</a> exists, which provides <em>MQTTBroker</em>, <em>MQTTIntegrator</em>, and <em>MQTTBridge</em> applications.</p>
<h1><a class="anchor" id="table-of-content"></a>
Table of Content</h1>
<ul>
<li>Simple Node in C++ (SNode.C)</li>
<li><a class="el" href="#table-of-content">Table of Content</a></li>
<li><a class="el" href="#license">License</a></li>
<li><a class="el" href="#copyright">Copyright</a></li>
<li><a class="el" href="#quick-starting-guide">Quick Starting Guide</a><ul>
<li><a class="el" href="#an-echo-application">An &quot;Echo&quot; Application</a><ul>
<li><a class="el" href="#socketserver-and-socketclient-instances">SocketServer and SocketClient Instances</a></li>
<li><a class="el" href="#socketcontextfactory-classes">SocketContextFactory Classes</a><ul>
<li><a class="el" href="#echo-server-socketcontextfactory">Echo-Server SocketContextFactory</a></li>
<li><a class="el" href="#echo-client-socketcontextfactory">Echo-Client SocketContextFactory</a></li>
</ul>
</li>
<li><a class="el" href="#socketcontext-classes">SocketContext Classes</a><ul>
<li><a class="el" href="#echo-server-socketcontext">Echo-Server SocketContext</a></li>
<li><a class="el" href="#echo-client-socketcontext">Echo-Client SocketContext</a></li>
</ul>
</li>
<li><a class="el" href="#main-applications-for-server-and-client">Main Applications for Server and Client</a><ul>
<li><a class="el" href="#echo-server-main-application">Echo-Server Main Application</a></li>
<li><a class="el" href="#echo-client-main-application">Echo-Client Main Application</a></li>
</ul>
</li>
<li><a class="el" href="#cmakeliststxt-file-for-building-and-installing-our-echoserver-and-echoclient">CMakeLists.txt file for Building and Installing our <em>echoserver</em> and <em>echoclient</em></a></li>
</ul>
</li>
<li><a class="el" href="#summary">Summary</a></li>
</ul>
</li>
<li><a class="el" href="#installation">Installation</a><ul>
<li><a class="el" href="#supported-systems-and-hardware">Supported Systems and Hardware</a></li>
<li><a class="el" href="#minimum-required-compiler-versions">Minimum required Compiler Versions</a></li>
<li><a class="el" href="#requirements-and-dependencies">Requirements and Dependencies</a><ul>
<li><a class="el" href="#tools">Tools</a><ul>
<li><a class="el" href="#mandatory">Mandatory</a></li>
<li><a class="el" href="#optional">Optional</a></li>
</ul>
</li>
<li><a class="el" href="#libraries">Libraries</a><ul>
<li><a class="el" href="#mandatory-1">Mandatory</a></li>
<li><a class="el" href="#optional-1">Optional</a></li>
<li><a class="el" href="#in-framework">In-Framework</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#installation-on-debian-style-systems-x86-64-arm">Installation on Debian Style Systems (x86-64, Arm)</a><ul>
<li><a class="el" href="#requirements-and-dependencies-1">Requirements and Dependencies</a></li>
<li><a class="el" href="#snodec">SNode.C</a></li>
</ul>
</li>
<li><a class="el" href="#deploment-on-openwrt">Deploment on OpenWRT</a><ul>
<li><a class="el" href="#choose-and-download-a-sdk">Choose and Download a SDK</a></li>
<li><a class="el" href="#patch-the-sdk-to-integrate-the-snodec-feed">Patch the SDK to Integrate the SNode.C Feed</a></li>
<li><a class="el" href="#install-the-snodec-package-and-its-dependencies">Install the SNode.C Package and its Dependencies</a></li>
<li><a class="el" href="#configure-the-sdk">Configure the SDK</a></li>
<li><a class="el" href="#cross-compile-snodec">Cross Compile SNode.C</a></li>
<li><a class="el" href="#deploy-snodec">Deploy SNode.C</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#design-decisions-and-features">Design Decisions and Features</a></li>
<li><a class="el" href="#fundamental-architecture">Fundamental Architecture</a><ul>
<li><a class="el" href="#network-layer">Network Layer</a></li>
<li><a class="el" href="#transport-layer">Transport Layer</a></li>
<li><a class="el" href="#connection-layer">Connection Layer</a></li>
<li><a class="el" href="#application-layer">Application Layer</a></li>
</ul>
</li>
<li><a class="el" href="#existing-socketserver-and-socketclient-classes">Existing SocketServer and SocketClient Classes</a><ul>
<li><a class="el" href="#common-aspects-of-socketserver-and-socketclient-classes">Common Aspects of SocketServer and SocketClient Classes</a><ul>
<li><a class="el" href="#socketaddress">SocketAddress</a><ul>
<li><a class="el" href="#socketaddress-constructors">SocketAddress Constructors</a></li>
</ul>
</li>
<li><a class="el" href="#socketconnection">SocketConnection</a><ul>
<li><a class="el" href="#most-important-common-socketconnection-methods">Most Important common SocketConnection Methods</a></li>
</ul>
</li>
<li><a class="el" href="#constructors-of-socketserver-and-socketclient-classes">Constructors of SocketServer and SocketClient Classes</a><ul>
<li><a class="el" href="#all-constructors-of-socketserver-classes">All Constructors of SocketServer Classes</a></li>
<li><a class="el" href="#all-constructors-of-socketclient-classes">All Constructors of SocketClient Classes</a></li>
</ul>
</li>
<li><a class="el" href="#constructor-callbacks">Constructor Callbacks</a><ul>
<li><a class="el" href="#the-onconnect-callback">The onConnect Callback</a></li>
<li><a class="el" href="#the-onconnected-callback">The onConnected Callback</a></li>
<li><a class="el" href="#the-ondisconnected-callback">The onDisconnected Callback</a></li>
<li><a class="el" href="#attaching-the-callbacks-during-instance-creation">Attaching the Callbacks during Instance Creation</a></li>
<li><a class="el" href="#attaching-the-callbacks-to-already-existing-instances">Attaching the Callbacks to already existing Instances</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#socketserver-classes">SocketServer Classes</a><ul>
<li><a class="el" href="#socketserver-header-files">SocketServer Header Files</a></li>
<li><a class="el" href="#listen-methods">Listen Methods</a><ul>
<li><a class="el" href="#socketaddress-types">SocketAddress Types</a></li>
<li><a class="el" href="#the-coresocketstate-object">The core::socket::State Object</a></li>
<li><a class="el" href="#common-listen-methods">Common listen() Methods</a></li>
<li><a class="el" href="#ipv4-specific-listen-methods">IPv4 specific listen() Methods</a></li>
<li><a class="el" href="#ipv6-specific-listen-methods">IPv6 specific listen() Methods</a></li>
<li><a class="el" href="#unix-domain-socket-specific-listen-methods">Unix Domain Socket specific listen() Methods</a></li>
<li><a class="el" href="#bluetooth-rfcomm-specific-listen-methods">Bluetooth RFCOMM specific listen() Methods</a></li>
<li><a class="el" href="#bluetooth-l2cap-specific-listen-methods">Bluetooth L2CAP specific listen() Methods</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#socketclient-classes">SocketClient Classes</a><ul>
<li><a class="el" href="#socketclient-header-files">SocketClient Header Files</a></li>
<li><a class="el" href="#connect-methods">Connect Methods</a><ul>
<li><a class="el" href="#socketaddress-types-1">SocketAddress Types</a></li>
<li><a class="el" href="#the-coresocketstate-object-1">The core::socket::State Object</a></li>
<li><a class="el" href="#common-connect-methods">Common connect() Methods</a></li>
<li><a class="el" href="#ipv4-specific-connect-methods">IPv4 specific connect() Methods</a></li>
<li><a class="el" href="#ipv6-specific-connect-methods">IPv6 specific connect() Methods</a></li>
<li><a class="el" href="#unix-domain-socket-specific-connect-methods">Unix Domain Socket specific connect() Methods</a></li>
<li><a class="el" href="#bluetooth-rfcomm-specific-connect-methods">Bluetooth RFCOMM specific connect() Methods</a></li>
<li><a class="el" href="#bluetooth-l2cap-specific-connect-methods">Bluetooth L2CAP specific connect() Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#configuration">Configuration</a><ul>
<li><a class="el" href="#three-different-options-for-configuration">Three different Options for Configuration</a><ul>
<li><a class="el" href="#configuration-using-the-c-api">Configuration using the C++ API</a><ul>
<li><a class="el" href="#list-of-all-configuration-items">List of all Configuration Items</a></li>
</ul>
</li>
<li><a class="el" href="#configuration-via-the-command-line">Configuration via the Command Line</a><ul>
<li><a class="el" href="#application-configuration">Application Configuration</a></li>
<li><a class="el" href="#instance-configuration">Instance Configuration</a><ul>
<li><a class="el" href="#sections">Sections</a></li>
<li><a class="el" href="#using-the-parameterless-listen-methods-when-no-configuration-file-exists">Using the Parameterless listen() Methods when no Configuration File exists</a></li>
<li><a class="el" href="#using-the-parameterless-connect-methods-when-no-configuration-file-exists">Using the Parameterless connect() Methods when no Configuration File exists</a></li>
</ul>
</li>
<li><a class="el" href="#anatomy-of-the-command-line-interface">Anatomy of the Command Line Interface</a></li>
</ul>
</li>
<li><a class="el" href="#configuration-via-a-configuration-file">Configuration via a Configuration File</a><ul>
<li><a class="el" href="#configuration-file-format">Configuration File Format</a></li>
<li><a class="el" href="#default-name-of-a-configuration-file">Default Name of a Configuration File</a></li>
<li><a class="el" href="#default-location-of-configuration-files">Default Location of Configuration Files</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#important-configuration-sections">Important Configuration Sections</a><ul>
<li><a class="el" href="#ssltls-configuration-section-tls">SSL/TLS Configuration (Section <em>tls</em>)</a><ul>
<li><a class="el" href="#ssltls-in-code-configuration">SSL/TLS In-Code Configuration</a></li>
<li><a class="el" href="#ssltls-command-line-configuration">SSL/TLS Command Line Configuration</a></li>
<li><a class="el" href="#using-ssltls-with-other-network-layers">Using SSL/TLS with Other Network Layers</a></li>
</ul>
</li>
<li><a class="el" href="#socket-configuration-section-socket">Socket Configuration (Section <em>socket</em>)</a><ul>
<li><a class="el" href="#common-socket-options-for-socketserver-and-socketclient-instances">Common <em>socket</em> Options for <em>SocketServer</em> and <em>SocketClient</em> Instances</a></li>
<li><a class="el" href="#specific-socket-options-for-ipv4-and-ipv6-socketserver">Specific <em>socket</em> Options for IPv4 and IPv6 <em>SocketServer</em></a></li>
<li><a class="el" href="#specific-socket-options-for-ipv6-socketserver-and-socketclient">Specific <em>socket</em> Options for IPv6 <em>SocketServer</em> and <em>SocketClient</em></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="el" href="#using-more-than-one-instance-in-an-application">Using More Than One Instance in an Application</a></li>
<li><a class="el" href="#application-leyer-protocols-apis">Application Leyer Protocols APIs</a><ul>
<li><a class="el" href="#basic-http-server-and-http-client-api">Basic HTTP-Server and HTTP-Client API</a></li>
<li><a class="el" href="#highlevel-web-api-ala-nodejs-express">Highlevel WEB-API a'la Node.JS-Express</a></li>
<li><a class="el" href="#websockets">WebSockets</a></li>
<li><a class="el" href="#basic-mqtt-server-and-mqtt-client-api">Basic MQTT-Server and MQTT-Client API</a></li>
<li><a class="el" href="#mqtt-over-websocket">MQTT Over WebSocket</a></li>
</ul>
</li>
<li><a class="el" href="#database-support">Database Support</a><ul>
<li><a class="el" href="#mariadb">MariaDB</a></li>
</ul>
</li>
<li><a class="el" href="#example-applications">Example Applications</a><ul>
<li><a class="el" href="#https-web-server-for-static-html-pages">HTTP/S Web-Server for Static HTML-Pages</a></li>
<li><a class="el" href="#receive-data-via-http-post-request">Receive Data via HTTP-Post Request</a></li>
<li><a class="el" href="#extract-server-and-client-information-host-name-ip-port-ssltls-information">Extract Server and Client Information (host name, IP, port, SSL/TLS information)</a></li>
<li><a class="el" href="#using-regular-expressions-in-routes">Using Regular Expressions in Routes</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>SNode.C is dual-licensed under MIT and LGPL-3.0 (or any later version). You can choose between one of them if you use this work.</p>
<p><code>SPDX-License-Identifier: MIT OR LGPL-3.0-or-later</code></p>
<h1><a class="anchor" id="copyright"></a>
Copyright</h1>
<p>Volker Christian (<a href="#" onclick="location.href='mai'+'lto:'+'me@'+'vc'+'hri'+'st'+'.at'; return false;">me@vchrist.at</a> or <a href="#" onclick="location.href='mai'+'lto:'+'vol'+'ke'+'r.c'+'hr'+'ist'+'ia'+'n@f'+'h-'+'hag'+'en'+'ber'+'g.'+'at'; return false;">Volker.Christian@fh-hagenberg.at</a>)</p>
<p>Some components are also copyrighted by students:</p>
<ul>
<li>Json Middleware<ul>
<li>Marlene Mayr</li>
<li>Anna Moser</li>
<li>Matteo Prock</li>
<li>Eric Thalhammer</li>
</ul>
</li>
<li>Regular-Expression Route-Mapping<ul>
<li>Joelle Helgert</li>
<li>Julia Gruber</li>
<li>Patrick Brandstätter</li>
<li>Fabian Mohr</li>
</ul>
</li>
<li>MariaDB Database Support<ul>
<li>Daniel Flockert</li>
</ul>
</li>
<li>OAuth2 Demo System<ul>
<li>Daniel Flockert</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="quick-starting-guide"></a>
Quick Starting Guide</h1>
<p>The architecture of every server and client application is basically the same and consists of three components.</p>
<ul>
<li><code>SocketServer</code> respective <code>SocketClient</code> instance</li>
<li><code>SocketContextFactory</code></li>
<li><code>SocketContext</code></li>
</ul>
<p>Let\'s have a look at how these components are related to each other by implementing a simple networking application.</p>
<h2><a class="anchor" id="an-echo-application"></a>
An "Echo" Application</h2>
<p>Imagine we want to create a very basic TCP (<code>stream</code>)/IPv4 (<code>in</code>) server/client pair which sends some plain text data unencrypted (<code>legacy</code>) to each other in a ping-pong fashion.</p>
<p>The client starts to send text data to the server and the server reflects this data back to the client. The client receives the reflected data and sends it back to the server again. This data-ping-pong should last infinitely long.</p>
<p>The code of this demo application can be found on <a href="https://github.com/SNodeC/echo">github</a>.</p>
<h3><a class="anchor" id="socketserver-and-socketclient-instances"></a>
<code>SocketServer</code> and <code>SocketClient</code> Instances</h3>
<p>For the <em>server role</em> we just need to create an object of type</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;SocketContextFactory&gt;</a></div>
<div class="ttc" id="aclassnet_1_1in_1_1stream_1_1SocketServer_html"><div class="ttname"><a href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::SocketServer</a></div><div class="ttdef"><b>Definition</b> <a href="net_2in_2stream_2SocketServer_8h_source.html#l00062">SocketServer.h:65</a></div></div>
</div><!-- fragment --><p>called <a class="el" href="#socketserver-classes">*server instance*</a> and for the <em>client role</em> an object of type</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketClient.html">net::in::stream::legacy::SocketClient&lt;SocketContextFactory&gt;</a></div>
<div class="ttc" id="aclassnet_1_1in_1_1stream_1_1SocketClient_html"><div class="ttname"><a href="classnet_1_1in_1_1stream_1_1SocketClient.html">net::in::stream::SocketClient</a></div><div class="ttdef"><b>Definition</b> <a href="net_2in_2stream_2SocketClient_8h_source.html#l00062">SocketClient.h:65</a></div></div>
</div><!-- fragment --><p>is required, called <a class="el" href="#socketclient-classes">*client instance*</a>.</p>
<p>A class <code>SocketContextFactory</code> is used for both instances as template argument. Such a <code>SocketContextFactory</code> needs to be provided by the user and is used internally by the <code>SocketServer</code> and the <code>SocketClient</code> instances to create a concrete <code>SocketContext</code> object for each established connection.</p>
<p>The <code>SocketContext</code> class must also be provided by the user and represents a concrete application protocol.</p>
<p>Therefore, for our <em>echo</em> application, we need to implement the <em>application protocol</em> for server and client in classes derived from <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code>, the base class of all connection-oriented (<code>stream</code>) application protocols, and factories derived from <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html">core::socket::stream::SocketContextFactory</a></code>.</p>
<p><em><b>Note</b></em>: Both, <code>SocketServer</code> and <code>SocketClient</code> classes have, among others, a <em>default constructor</em> and a constructor expecting an <em>instance name</em> as argument.</p>
<ul>
<li>In case the <em>default</em> constructor is used to create the instance, it is called an <em>anonymous instance</em>.</li>
<li>In contrast to a <em>named instance</em> if the constructors expecting a <code>std::string</code> is used.</li>
<li>For named instances <em>command line arguments</em> and <em>configuration file entries</em> are created automatically.</li>
</ul>
<h3><a class="anchor" id="socketcontextfactory-classes"></a>
<code>SocketContextFactory</code> Classes</h3>
<p>Let\'s focus on the <code>SocketContextFactory</code> classes for our server and client first.</p>
<p>All what needs to be done is to <em>implement a pure virtual method</em> <code>create()</code> witch expects a pointer to a <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> as argument and returns a pointer to a concrete <code>SocketContext</code>.</p>
<p>The <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> object involved is managed internally by SNode.C and <em>represents the network connection</em> between a server and a client. It is responsible for handling the <em>physical data exchange</em> and, in case of a SSL/TLS-secured connection, for <em>encryption</em> resp. <em>decryption</em>.</p>
<h4><a class="anchor" id="echo-server-socketcontextfactory"></a>
Echo-Server <code>SocketContextFactory</code></h4>
<p>The <code>create()</code> method of our <code>EchoServerContextFactory</code> returns a pointer to the <code>EchoServerContext</code> whose implementation is presented in the <a class="el" href="#socketcontext-classes">SocketContext Classes</a> section below.</p>
<p><em><b>Note</b></em>: A pointer to a <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> is passed as argument to the constructor of our <code>EchoServerContext</code>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;EchoServerContext.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2stream_2SocketContextFactory_8h.html">core/socket/stream/SocketContextFactory.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>EchoServerContextFactory : <span class="keyword">public</span> <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html">core::socket::stream::SocketContextFactory</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a>* <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html#a949c1b855fb495f0ab80d179e6a8c0b9">create</a>(<a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a>* socketConnection)<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> EchoServerContext(socketConnection);</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketConnection_html"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></div><div class="ttdef"><b>Definition</b> <a href="SocketConnection_8h_source.html#l00075">SocketConnection.h:75</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContextFactory_html"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html">core::socket::stream::SocketContextFactory</a></div><div class="ttdef"><b>Definition</b> <a href="core_2socket_2stream_2SocketContextFactory_8h_source.html#l00056">SocketContextFactory.h:56</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContextFactory_html_a949c1b855fb495f0ab80d179e6a8c0b9"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html#a949c1b855fb495f0ab80d179e6a8c0b9">core::socket::stream::SocketContextFactory::create</a></div><div class="ttdeci">virtual core::socket::stream::SocketContext * create(core::socket::stream::SocketConnection *socketConnection)=0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></div><div class="ttdef"><b>Definition</b> <a href="core_2socket_2stream_2SocketContext_8h_source.html#l00064">SocketContext.h:64</a></div></div>
<div class="ttc" id="acore_2socket_2stream_2SocketContextFactory_8h_html"><div class="ttname"><a href="core_2socket_2stream_2SocketContextFactory_8h.html">SocketContextFactory.h</a></div></div>
</div><!-- fragment --><h4><a class="anchor" id="echo-client-socketcontextfactory"></a>
Echo-Client <code>SocketContextFactory</code></h4>
<p>The <code>create()</code> method of our <code>EchoClientContextFactory</code> returns a pointer to the <code>EchoClientContext</code> whose implementation is also presented in the <a class="el" href="#socketcontext-classes">SocketContext Classes</a> section below.</p>
<p><em><b>Note</b></em>: A pointer to a <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> is passed as argument to the constructor of our <code>EchoServerContext</code>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;EchoClientContext.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2stream_2SocketContextFactory_8h.html">core/socket/stream/SocketContextFactory.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>EchoClientContextFactory : <span class="keyword">public</span> <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html">core::socket::stream::SocketContextFactory</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a>* <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html#a949c1b855fb495f0ab80d179e6a8c0b9">create</a>(<a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a>* socketConnection)<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> EchoClientContext(socketConnection);</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><p>That\'s easy, isn\'t it?</p>
<h3><a class="anchor" id="socketcontext-classes"></a>
<code>SocketContext</code> Classes</h3>
<p>It is also not difficult to implement the <code>SocketContext</code> classes for the server and the client.</p>
<ul>
<li>Remember, the required functionality:<ul>
<li>The <em>client shall start</em> sending data to the server.</li>
<li>The <em>server shall reflect</em> the received data back to the client.</li>
<li>The client shall reflect the received data back to the server.</li>
</ul>
</li>
<li>Also remember:<ul>
<li>We need to derive the <code>EchoServerContext</code> and <code>EchoClientContext</code> from the base class <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code>.</li>
</ul>
</li>
<li>And at last remember:<ul>
<li>The base class <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code> needs a <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> to handle the physical data exchange. Thus, we have to pass the pointer to the <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code> to the constructor of the base class <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code>.</li>
</ul>
</li>
</ul>
<p><em><b>Note</b></em>: The base class <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code> provides some <em>virtual methods</em> which can be <em>overridden</em> in a concrete <code>SocketContext</code> class. These methods will be <em>called by the framework</em> automatically.</p>
<h4><a class="anchor" id="echo-server-socketcontext"></a>
Echo-Server <code>SocketContext</code></h4>
<p>For our echo server application it would be sufficient to override the <code>onReceivedFromPeer()</code> method only. This method is called by the framework in case some <em>data have already been received</em> from the client. Nevertheless, for more information of what is going on in behind, the methods <code>onConnected()</code> and <code>onDisconnected()</code> are overridden also.</p>
<p>In the <code>onReceivedFromPeer()</code> method, we can retrieve that data using the method <code>readFromPeer()</code>, which is provided by the <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code> class.</p>
<p>Sending data to the client is done using the method <code>sendToPeer()</code>, which is also provided by the <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code> class.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2SocketAddress_8h.html">core/socket/SocketAddress.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SocketConnection_8h.html">core/socket/stream/SocketConnection.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2stream_2SocketContext_8h.html">core/socket/stream/SocketContext.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Logger_8h.html">log/Logger.h</a>&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>EchoServerContext : <span class="keyword">public</span> <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#acf0a2bbf56762577ced1dddc0914bc94">core::socket::stream::SocketContext::SocketContext</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a716a54b882173251b584439499ca0446">onConnected</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case a connection has been established successfully.</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo connected to &quot;</span> &lt;&lt; <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a02f0b93ac0ea376dabd6921c7589a8cf">getSocketConnection</a>()-&gt;<a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html#a8676b9150b85fb2d2e5ef1d8daee0480">getRemoteAddress</a>().<a class="code hl_function" href="classcore_1_1socket_1_1SocketAddress.html#a46b6e56ceceba959ca208ef4acf00137">toString</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#ab9c932c5c1b706ffb84d97634514d20e">onDisconnected</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case the connection has been closed.</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo disconnected from &quot;</span> &lt;&lt; <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a02f0b93ac0ea376dabd6921c7589a8cf">getSocketConnection</a>()-&gt;<a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html#a8676b9150b85fb2d2e5ef1d8daee0480">getRemoteAddress</a>().<a class="code hl_function" href="classcore_1_1socket_1_1SocketAddress.html#a46b6e56ceceba959ca208ef4acf00137">toString</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#ad5a47157710544f1d90f1ebdf15fe49e">onSignal</a>(<span class="keywordtype">int</span> signum)<span class="keyword"> override </span>{ <span class="comment">// Called in case a signal has been received</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo disconnected due to signal=&quot;</span> &lt;&lt; signum;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Close the connection</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::size_t <a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#a34c520f17818f029395d2d2b4babc882">onReceivedFromPeer</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case data have already been received by the framework</span></div>
<div class="line">                                                <span class="comment">// and thus are ready for preccessing.</span></div>
<div class="line">        <span class="keywordtype">char</span> junk[4096];</div>
<div class="line"> </div>
<div class="line">        std::size_t junkLen = <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a5401a6174dbad9a6637c684a0fb952d9">readFromPeer</a>(junk, 4096); <span class="comment">// Fetch data.</span></div>
<div class="line">                                                        <span class="comment">// In case there are less than 4096 bytes available return at</span></div>
<div class="line">                                                        <span class="comment">// least that amount of data.</span></div>
<div class="line">                                                        <span class="comment">// In case more than 4096 bytes are available</span></div>
<div class="line">                                                        <span class="comment">// onReceivedFromPeer will be called again.</span></div>
<div class="line">                                                        <span class="comment">// No error can occure here.</span></div>
<div class="line">        <span class="keywordflow">if</span> (junkLen &gt; 0) {</div>
<div class="line">            VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Data to reflect: &quot;</span> &lt;&lt; std::string(junk, junkLen);</div>
<div class="line">            <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a7e80affcdada3ef5f1c52c283d65a89c">sendToPeer</a>(junk, junkLen); <span class="comment">// Reflect the received data back to the client.</span></div>
<div class="line">                                       <span class="comment">// Out of memory is the only error which can occure here.</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> junkLen; <span class="comment">// Return the amount of data processed to the framework.</span></div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aLogger_8h_html"><div class="ttname"><a href="Logger_8h.html">Logger.h</a></div></div>
<div class="ttc" id="aSocketConnection_8h_html"><div class="ttname"><a href="SocketConnection_8h.html">SocketConnection.h</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1SocketAddress_html_a46b6e56ceceba959ca208ef4acf00137"><div class="ttname"><a href="classcore_1_1socket_1_1SocketAddress.html#a46b6e56ceceba959ca208ef4acf00137">core::socket::SocketAddress::toString</a></div><div class="ttdeci">virtual std::string toString(bool expanded=true) const =0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1SocketContext_html_a34c520f17818f029395d2d2b4babc882"><div class="ttname"><a href="classcore_1_1socket_1_1SocketContext.html#a34c520f17818f029395d2d2b4babc882">core::socket::SocketContext::onReceivedFromPeer</a></div><div class="ttdeci">virtual std::size_t onReceivedFromPeer()=0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1SocketContext_html_acf0a2bbf56762577ced1dddc0914bc94"><div class="ttname"><a href="classcore_1_1socket_1_1SocketContext.html#acf0a2bbf56762577ced1dddc0914bc94">core::socket::SocketContext::SocketContext</a></div><div class="ttdeci">SocketContext()=default</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1SocketContext_html_ad5a47157710544f1d90f1ebdf15fe49e"><div class="ttname"><a href="classcore_1_1socket_1_1SocketContext.html#ad5a47157710544f1d90f1ebdf15fe49e">core::socket::SocketContext::onSignal</a></div><div class="ttdeci">virtual bool onSignal(int sig)=0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketConnection_html_a8676b9150b85fb2d2e5ef1d8daee0480"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketConnection.html#a8676b9150b85fb2d2e5ef1d8daee0480">core::socket::stream::SocketConnection::getRemoteAddress</a></div><div class="ttdeci">virtual const core::socket::SocketAddress &amp; getRemoteAddress() const =0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html_a02f0b93ac0ea376dabd6921c7589a8cf"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a02f0b93ac0ea376dabd6921c7589a8cf">core::socket::stream::SocketContext::getSocketConnection</a></div><div class="ttdeci">SocketConnection * getSocketConnection() const</div><div class="ttdef"><b>Definition</b> <a href="core_2socket_2stream_2SocketContext_8cpp_source.html#l00065">SocketContext.cpp:65</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html_a5401a6174dbad9a6637c684a0fb952d9"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a5401a6174dbad9a6637c684a0fb952d9">core::socket::stream::SocketContext::readFromPeer</a></div><div class="ttdeci">std::size_t readFromPeer(char *chunk, std::size_t chunklen) const final</div><div class="ttdef"><b>Definition</b> <a href="core_2socket_2stream_2SocketContext_8cpp_source.html#l00081">SocketContext.cpp:81</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html_a716a54b882173251b584439499ca0446"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a716a54b882173251b584439499ca0446">core::socket::stream::SocketContext::onConnected</a></div><div class="ttdeci">virtual void onConnected()=0</div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html_a7e80affcdada3ef5f1c52c283d65a89c"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a7e80affcdada3ef5f1c52c283d65a89c">core::socket::stream::SocketContext::sendToPeer</a></div><div class="ttdeci">void sendToPeer(const char *chunk, std::size_t chunkLen) const final</div><div class="ttdef"><b>Definition</b> <a href="core_2socket_2stream_2SocketContext_8cpp_source.html#l00069">SocketContext.cpp:69</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1stream_1_1SocketContext_html_ab9c932c5c1b706ffb84d97634514d20e"><div class="ttname"><a href="classcore_1_1socket_1_1stream_1_1SocketContext.html#ab9c932c5c1b706ffb84d97634514d20e">core::socket::stream::SocketContext::onDisconnected</a></div><div class="ttdeci">virtual void onDisconnected()=0</div></div>
<div class="ttc" id="acore_2socket_2SocketAddress_8h_html"><div class="ttname"><a href="core_2socket_2SocketAddress_8h.html">SocketAddress.h</a></div></div>
<div class="ttc" id="acore_2socket_2stream_2SocketContext_8h_html"><div class="ttname"><a href="core_2socket_2stream_2SocketContext_8h.html">SocketContext.h</a></div></div>
</div><!-- fragment --><h4><a class="anchor" id="echo-client-socketcontext"></a>
Echo-Client <code>SocketContext</code></h4>
<p>Unlike the <code>EchoServerContext</code>, the <code>EchoClientContext</code> <em>needs</em> an overridden <code>onConnected()</code> method, in which the method <code>sendToPeer()</code> is used to <em>initiate</em> the ping-pong data exchange.</p>
<p>And like in the <code>EchoServerContext</code>, <code>readFromPeer()</code> and <code>sendToPeer()</code> is used in the <code>onReceivedFromPeer()</code> to receive and reflect the data.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2SocketAddress_8h.html">core/socket/SocketAddress.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SocketConnection_8h.html">core/socket/stream/SocketConnection.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="core_2socket_2stream_2SocketContext_8h.html">core/socket/stream/SocketContext.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Logger_8h.html">log/Logger.h</a>&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>EchoClientContext : <span class="keyword">public</span> <a class="code hl_class" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#acf0a2bbf56762577ced1dddc0914bc94">core::socket::stream::SocketContext::SocketContext</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a716a54b882173251b584439499ca0446">onConnected</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case a connection has been established successfully.</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo connected to &quot;</span> &lt;&lt; <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a02f0b93ac0ea376dabd6921c7589a8cf">getSocketConnection</a>()-&gt;<a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html#a8676b9150b85fb2d2e5ef1d8daee0480">getRemoteAddress</a>().<a class="code hl_function" href="classcore_1_1socket_1_1SocketAddress.html#a46b6e56ceceba959ca208ef4acf00137">toString</a>();</div>
<div class="line"> </div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Initiating data exchange&quot;</span>;</div>
<div class="line">        <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a7e80affcdada3ef5f1c52c283d65a89c">sendToPeer</a>(<span class="stringliteral">&quot;Hello peer! It&#39;s nice talking to you\n&quot;</span>); <span class="comment">// Initiate the ping-pong data exchange.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#ab9c932c5c1b706ffb84d97634514d20e">onDisconnected</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case the connection has been closed.</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo disconnected from &quot;</span> &lt;&lt; <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a02f0b93ac0ea376dabd6921c7589a8cf">getSocketConnection</a>()-&gt;<a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html#a8676b9150b85fb2d2e5ef1d8daee0480">getRemoteAddress</a>().<a class="code hl_function" href="classcore_1_1socket_1_1SocketAddress.html#a46b6e56ceceba959ca208ef4acf00137">toString</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#ad5a47157710544f1d90f1ebdf15fe49e">onSignal</a>(<span class="keywordtype">int</span> signum)<span class="keyword"> override </span>{ <span class="comment">// Called in case a signal has been received</span></div>
<div class="line">        VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Echo disconnected due to signal=&quot;</span> &lt;&lt; signum;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Close the connection</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::size_t <a class="code hl_function" href="classcore_1_1socket_1_1SocketContext.html#a34c520f17818f029395d2d2b4babc882">onReceivedFromPeer</a>()<span class="keyword"> override </span>{ <span class="comment">// Called in case data have already been received by the framework</span></div>
<div class="line">                                                <span class="comment">// and thus are ready for preccessing.</span></div>
<div class="line">        <span class="keywordtype">char</span> junk[4096];</div>
<div class="line"> </div>
<div class="line">        std::size_t junkLen = <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a5401a6174dbad9a6637c684a0fb952d9">readFromPeer</a>(junk, 4096); <span class="comment">// Fetch data.</span></div>
<div class="line">                                                        <span class="comment">// In case there are less than 4096 bytes available return at</span></div>
<div class="line">                                                        <span class="comment">// least that amount of data.</span></div>
<div class="line">                                                        <span class="comment">// In case more than 4096 bytes are available</span></div>
<div class="line">                                                        <span class="comment">// onReceivedFromPeer will be called again.</span></div>
<div class="line">                                                        <span class="comment">// No error can occure here.</span></div>
<div class="line">        <span class="keywordflow">if</span> (junkLen &gt; 0) {</div>
<div class="line">            VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Data to reflect: &quot;</span> &lt;&lt; std::string(junk, junkLen);</div>
<div class="line">            <a class="code hl_function" href="classcore_1_1socket_1_1stream_1_1SocketContext.html#a7e80affcdada3ef5f1c52c283d65a89c">sendToPeer</a>(junk, junkLen); <span class="comment">// Reflect the received data back to the server.</span></div>
<div class="line">                                       <span class="comment">// Out of memory is the only error which can occure here.</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> junkLen; <span class="comment">// Return the amount of data processed to the framework.</span></div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="main-applications-for-server-and-client"></a>
Main Applications for Server and Client</h3>
<p>Now we can combine everything to implement the server and client applications. Here <em>anonymous instances</em> are used. We therefore do not automatically receive command line arguments.</p>
<p><em><b>Note</b></em>: The use of our previously implemented <code>EchoServerContextFactory</code> and <code>EchoClientContextFactory</code> as template arguments.</p>
<p>At the very beginning SNode.C must be <em>initialized</em> by calling</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a>(argc, argv);</div>
<div class="ttc" id="aclasscore_1_1SNodeC_html_a2c8b01c5fc6ecc3036cb48a76f76f3b5"><div class="ttname"><a href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a></div><div class="ttdeci">static void init(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="SNodeC_8cpp_source.html#l00054">SNodeC.cpp:54</a></div></div>
</div><!-- fragment --><p>and at the end of the main applications the <em>event-loop</em> of SNode.C is <em>started</em> by calling</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a>();</div>
<div class="ttc" id="aclasscore_1_1SNodeC_html_ac3d0dcb6c216ae72d9bbb77fe080e461"><div class="ttname"><a href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a></div><div class="ttdeci">static int start(const utils::Timeval &amp;timeOut={LONG_MAX, 0})</div><div class="ttdef"><b>Definition</b> <a href="SNodeC_8cpp_source.html#l00060">SNodeC.cpp:60</a></div></div>
</div><!-- fragment --><h4><a class="anchor" id="echo-server-main-application"></a>
Echo-Server Main Application</h4>
<p>The server instance <code>echoServer</code> must be <em>activated</em> by calling <code>echoServer.listen()</code>.</p>
<p>SNode.C provides a view <a class="el" href="#listen-methods">overloaded `listen()`</a> methods whose arguments vary depending on the network layer (IPv4, IPv6, RFCOMM, L2CAP, or unix domain sockets) used. Though, every <code>listen()</code> method expects a <em>lambda function</em> as one of its arguments.</p>
<p>Here we use IPv4 and the <code>listen()</code> method which expects a port number, here <code>8001</code>, as argument. Note that we do not bind the <code>echoServer</code> to a specific network interface. Thus it can be contacted via all active physical network interfaces.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;EchoServerContextFactory.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SNodeC_8h.html">core/SNodeC.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="net_2in_2stream_2legacy_2SocketServer_8h.html">net/in/stream/legacy/SocketServer.h</a>&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a>(argc, argv); <span class="comment">// Initialize the framework.</span></div>
<div class="line">                                    <span class="comment">// Configure logging, create command line</span></div>
<div class="line">                                    <span class="comment">// arguments for named instances.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>EchoServer = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>; <span class="comment">// Simplify data type</span></div>
<div class="line">                                                                                        <span class="comment">// Note the use of our implemented</span></div>
<div class="line">                                                                                        <span class="comment">// EchoServerContextFactory as</span></div>
<div class="line">                                                                                        <span class="comment">// template argument</span></div>
<div class="line">    <span class="keyword">using </span>SocketAddress = EchoServer::SocketAddress;                                    <span class="comment">// Simplify data type</span></div>
<div class="line"> </div>
<div class="line">    EchoServer echoServer; <span class="comment">// Create server instance and listen on all interfaces on port 8001</span></div>
<div class="line">    echoServer.listen(8001, 5, [](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServer: connected to &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServer: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServer: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServer: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a>(); <span class="comment">// Start the event loop, daemonize if requested.</span></div>
<div class="line">}</div>
<div class="ttc" id="aSNodeC_8h_html"><div class="ttname"><a href="SNodeC_8h.html">SNodeC.h</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html"><div class="ttname"><a href="classcore_1_1socket_1_1State.html">core::socket::State</a></div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8h_source.html#l00053">State.h:53</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html_a26b8a9154524cfbba2729255cb184331"><div class="ttname"><a href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a></div><div class="ttdeci">static constexpr int DISABLED</div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8h_source.html#l00056">State.h:56</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html_a3dcc747a68a4c163fcf1c57d9852cab3"><div class="ttname"><a href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a></div><div class="ttdeci">static constexpr int ERROR</div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8h_source.html#l00057">State.h:57</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html_a55b6abd55034b331fae4c9e085007dfa"><div class="ttname"><a href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">core::socket::State::what</a></div><div class="ttdeci">std::string what() const</div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8cpp_source.html#l00114">State.cpp:114</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html_a5d0a9047c96edac9ffd9cd12574328c0"><div class="ttname"><a href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a></div><div class="ttdeci">static constexpr int FATAL</div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8h_source.html#l00058">State.h:58</a></div></div>
<div class="ttc" id="aclasscore_1_1socket_1_1State_html_a744e04217104f055ae728e8d884f25de"><div class="ttname"><a href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a></div><div class="ttdeci">static constexpr int OK</div><div class="ttdef"><b>Definition</b> <a href="socket_2State_8h_source.html#l00055">State.h:55</a></div></div>
<div class="ttc" id="aconfigtest_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="configtest_8cpp_source.html#l00067">configtest.cpp:67</a></div></div>
<div class="ttc" id="anet_2in_2stream_2legacy_2SocketServer_8h_html"><div class="ttname"><a href="net_2in_2stream_2legacy_2SocketServer_8h.html">SocketServer.h</a></div></div>
</div><!-- fragment --><p>If we would have created a <em>named server instance</em>, a <em>special</em> <code>listen()</code> method can be used that only expects the <em>lambda</em> as argument. In that case the configuration of this instance is required to be done using the <em>command line interface</em> and/or a <em>configuration file</em>.</p>
<h4><a class="anchor" id="echo-client-main-application"></a>
Echo-Client Main Application</h4>
<p>The client instance <code>echoClient</code> must be <em>activated</em> by calling <code>echoClient.connect()</code>.</p>
<p>Equivalent to the server instance a client instance provides a view <a class="el" href="#connect-methods">overloaded `connect()`</a> methods whose arguments also vary depending on the network layer used. Though, every <code>connect()</code> method expects a <em>lambda function</em> as one of its arguments.</p>
<p>Here it is assumed that we talk to an IPv4 server which runs on the same machine as the client. Thus we pass the host name <code>localhost</code> and port number <code>8001</code> as arguments to the <code>connect()</code> method.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;EchoClientContextFactory.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SNodeC_8h.html">core/SNodeC.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="net_2in_2stream_2legacy_2SocketClient_8h.html">net/in/stream/legacy/SocketClient.h</a>&gt;</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a>(argc, argv); <span class="comment">// Initialize the framework.</span></div>
<div class="line">                                    <span class="comment">// Configure logging, create command line</span></div>
<div class="line">                                    <span class="comment">// arguments for named instances.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>EchoClient = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketClient.html">net::in::stream::legacy::SocketClient&lt;EchoClientContextFactory&gt;</a>; <span class="comment">// Simplify data type</span></div>
<div class="line">                                                                                        <span class="comment">// Note the use of our implemented</span></div>
<div class="line">                                                                                        <span class="comment">// EchoClientContextFactory as</span></div>
<div class="line">                                                                                        <span class="comment">// template argument</span></div>
<div class="line">    <span class="keyword">using </span>SocketAddress = EchoClient::SocketAddress;                                    <span class="comment">// Simplify data type</span></div>
<div class="line"> </div>
<div class="line">    EchoClient echoClient; <span class="comment">// Create anonymous client instance and connect to localhost:8001</span></div>
<div class="line">    echoClient.connect(<span class="stringliteral">&quot;localhost&quot;</span>, 8001, [](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClient: connected to &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClient: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoClient: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoClient: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a>(); <span class="comment">// Start the event loop, daemonize if requested.</span></div>
<div class="line">}</div>
<div class="ttc" id="anet_2in_2stream_2legacy_2SocketClient_8h_html"><div class="ttname"><a href="net_2in_2stream_2legacy_2SocketClient_8h.html">SocketClient.h</a></div></div>
</div><!-- fragment --><p>If we would have created a <em>named client instance</em>, a special <code>connect()</code> method can be used that only expects the <em>lambda</em> as argument. In that case the configuration of this instance is required to be done using <em>command line arguments</em> and/or a <em>configuration file</em>.</p>
<h3><a class="anchor" id="cmakeliststxt-file-for-building-and-installing-our-echoserver-and-echoclient"></a>
CMakeLists.txt file for Building and Installing our <em>echoserver</em> and <em>echoclient</em></h3>
<p>There is nothing special in the file <code>CMakeLists.txt</code> which is used to build the echo server and client applications. Both executables, <code>echoserver</code> and <code>echoclient</code> are defined using <code>add_executable()</code>.</p>
<p>A bit more attention should be payed to the two lines <code>target_link_libraries()</code>. In our application we need support for an unencrypted (<code>legacy</code>), IPv4 (<code>in</code>), TCP (<code>stream</code>) connection. Thus we need to link the <code>echoserver</code> and <code>echoclient</code> executable against the <code>libsnodec-net-in-stream-legacy.so</code> library. To get the <em>CMake</em> configuration of that library we need to include the target <code>net-in-stream-legacy</code></p>
<div class="fragment"><div class="line">find_package(snodec COMPONENTS net-in-stream-legacy)</div>
</div><!-- fragment --><p>which is a <em>component of the package</em> <code>snodec</code></p>
<p>This library <em>transitively depends</em> on all other necessary and <em>only necessary</em> SNode.C, third party and system libraries to get a fully linked and runnable application.</p>
<p>Thus, the <code>CMakeLists.txt</code> file for our server and client applications looks like</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.3)</div>
<div class="line"> </div>
<div class="line">project(echo LANGUAGES CXX)</div>
<div class="line"> </div>
<div class="line">set(CMAKE_CXX_STANDARD 20)</div>
<div class="line">set(CMAKE_CXX_STANDARD_REQUIRED ON)</div>
<div class="line"> </div>
<div class="line">find_package(snodec COMPONENTS net-in-stream-legacy)</div>
<div class="line"> </div>
<div class="line">set(ECHOSERVER_CPP EchoServer.cpp)</div>
<div class="line">set(ECHOSERVER_H EchoServerContextFactory.h EchoServerContext.h)</div>
<div class="line"> </div>
<div class="line">add_executable(echoserver ${ECHOSERVER_CPP} ${ECHOSERVER_H})</div>
<div class="line">target_link_libraries(echoserver PRIVATE snodec::net-in-stream-legacy)</div>
<div class="line"> </div>
<div class="line">set(ECHOCLIENT_CPP EchoClient.cpp)</div>
<div class="line">set(ECHOCLIENT_H EchoClientContextFactory.h EchoClientContext.h)</div>
<div class="line"> </div>
<div class="line">add_executable(echoclient ${ECHOCLIENT_CPP} ${ECHOCLIENT_H})</div>
<div class="line">target_link_libraries(echoclient PRIVATE snodec::net-in-stream-legacy)</div>
<div class="line"> </div>
<div class="line">install(TARGETS echoserver echoclient RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR})</div>
</div><!-- fragment --><h2><a class="anchor" id="summary"></a>
Summary</h2>
<p>The echo application shows the <em>typical architecture</em> of servers and clients using SNode.C.</p>
<ul>
<li><p class="startli">The user needs to provide the application protocol layer by implementing the classes</p><ul>
<li><code>SocketContextFactory</code> and</li>
<li><code>SocketContext</code></li>
</ul>
<p class="startli">for server and client which need be be derived from the base classes</p><ul>
<li><code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContextFactory.html">core::socket::stream::SocketContextFactory</a></code></li>
<li><code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketContext.html">core::socket::stream::SocketContext</a></code></li>
</ul>
</li>
<li><p class="startli">The framework provides ready to use</p><ul>
<li><code>SocketServer</code> and</li>
<li><code>SocktClient</code></li>
</ul>
<p class="startli">classes for each network/transport layer combination.</p>
</li>
</ul>
<h1><a class="anchor" id="installation"></a>
Installation</h1>
<p>The installation of SNode.C is straight forward:</p>
<ul>
<li>In a first step all necessary tools and libraries are installed.</li>
<li>Afterwards SNode.C can be cloned, compiled and installed.</li>
</ul>
<h2><a class="anchor" id="supported-systems-and-hardware"></a>
Supported Systems and Hardware</h2>
<p>The main development of SNode.C takes place on a <em>Debian Sid</em> style Linux system. Since <em>Debian Bookworm</em> it compiles also on <em>Debian stable</em>. Though, it should compile cleanly on every Linux system provided that all required tools and libraries are installed.</p>
<p>SNode.C is known to compile and run successfull on</p>
<ul>
<li><b>x86-64</b> architecture</li>
<li><b>Arm</b> architecture (32 and 64 bit) tested on<ul>
<li>Raspberry Pi 3, 4, and 5</li>
</ul>
</li>
<li><b>OpenWrt</b> 23.05.0-rc1 and later<ul>
<li>All architectures</li>
</ul>
</li>
<li><b>Android</b> via <a href="https://termux.dev/en/">Termux</a><ul>
<li>Documentation in preparation</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="minimum-required-compiler-versions"></a>
Minimum required Compiler Versions</h2>
<p>The most version-critical dependencies are the C++ compilers.</p>
<p>Either <em>GCC</em> or <em>clang</em> can be used but they need to be of an up to date version because SNode.C uses some new C++20 features internally.</p>
<ul>
<li>GCC 12.2 and later</li>
<li>Clang 13.0 and later</li>
</ul>
<h2><a class="anchor" id="requirements-and-dependencies"></a>
Requirements and Dependencies</h2>
<p>SNode.C requires some external tools and depends on a view external libraries. Some of these libraries are directly included in the framework.</p>
<h3><a class="anchor" id="tools"></a>
Tools</h3>
<h4><a class="anchor" id="mandatory"></a>
Mandatory</h4>
<ul>
<li>git (<a href="https://git-scm.com/">https://git-scm.com/</a>)</li>
<li>cmake (<a href="https://cmake.org/">https://cmake.org/</a>)</li>
<li>make (<a href="https://www.gnu.org/software/make/">https://www.gnu.org/software/make/</a>) or</li>
<li>ninja (<a href="https://ninja-build.org/">https://ninja-build.org/</a>)</li>
<li>g++ (<a href="https://gcc.gnu.org/">https://gcc.gnu.org/</a>) or</li>
<li>clang (<a href="https://clang.llvm.org/">https://clang.llvm.org/</a>)</li>
<li>pkg-config (<a href="https://www.freedesktop.org/wiki/Software/pkg-config/">https://www.freedesktop.org/wiki/Software/pkg-config/</a>)</li>
</ul>
<h4><a class="anchor" id="optional"></a>
Optional</h4>
<ul>
<li>iwyu (<a href="https://include-what-you-use.org/">https://include-what-you-use.org/</a>)</li>
<li>clang-format (<a href="https://clang.llvm.org/docs/ClangFormat.html">https://clang.llvm.org/docs/ClangFormat.html</a>)</li>
<li>cmake-format (<a href="https://cmake-format.readthedocs.io/">https://cmake-format.readthedocs.io/</a>)</li>
<li>doxygen (<a href="https://www.doxygen.nl/">https://www.doxygen.nl/</a>)</li>
<li>wget (<a href="https://savannah.gnu.org/git/?group=wget">https://savannah.gnu.org/git/?group=wget</a>)</li>
</ul>
<h3><a class="anchor" id="libraries"></a>
Libraries</h3>
<h4><a class="anchor" id="mandatory-1"></a>
Mandatory</h4>
<ul>
<li>Easylogging++ (v9.97.0 or later) development files (<a href="https://github.com/amrayn/easyloggingpp/">https://github.com/amrayn/easyloggingpp/</a>)</li>
<li>OpenSSL (v1.1, v3.0, or v3.1) development files (<a href="https://www.openssl.org/">https://www.openssl.org/</a>)</li>
<li>Nlohmann-JSON (v3.11.2 or later) development files (<a href="https://json.nlohmann.me/">https://json.nlohmann.me/</a>)</li>
</ul>
<h4><a class="anchor" id="optional-1"></a>
Optional</h4>
<ul>
<li>BlueZ (version belonging to target Linux version) development files (<a href="http://www.bluez.org/">http://www.bluez.org/</a>)</li>
<li>LibMagic (v5.37 and later) development files (<a href="https://www.darwinsys.com/file/">https://www.darwinsys.com/file/</a>)</li>
<li>LibMariaDB (v2.1.0 and later) client MariaDB Connector/C development files (<a href="https://mariadb.org/">https://mariadb.org/</a>)</li>
</ul>
<h4><a class="anchor" id="in-framework"></a>
In-Framework</h4>
<p>This libraries are already integrated directly in SNode.C. Thus they need not be installed by hand</p>
<ul>
<li>CLI11 (<a href="https://github.com/CLIUtils/CLI11/">https://github.com/CLIUtils/CLI11/</a>)</li>
</ul>
<h2><a class="anchor" id="installation-on-debian-style-systems-x86-64-arm"></a>
Installation on Debian Style Systems (x86-64, Arm)</h2>
<h3><a class="anchor" id="requirements-and-dependencies-1"></a>
Requirements and Dependencies</h3>
<p>To install all dependencies on Debian style systems just run</p>
<div class="fragment"><div class="line">sudo apt update</div>
<div class="line">sudo apt install git cmake make ninja-build g++ clang pkg-config</div>
<div class="line">sudo apt install iwyu clang-format cmake-format doxygen</div>
<div class="line">sudo apt install libeasyloggingpp-dev libssl-dev nlohmann-json3-dev</div>
<div class="line">sudo apt install libbluetooth-dev libmagic-dev libmariadb-dev</div>
</div><!-- fragment --><h3><a class="anchor" id="snodec"></a>
SNode.C</h3>
<p>After installing all dependencies SNode.C can be cloned from github, compiled and installed.</p>
<div class="fragment"><div class="line">mkdir snode.c</div>
<div class="line">cd snode.c</div>
<div class="line">git clone https://github.com/SNodeC/snode.c.git</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ../snode.c</div>
<div class="line">make</div>
<div class="line">sudo make install</div>
<div class="line">sudo ldconfig</div>
<div class="line">sudo groupadd --system snodec</div>
<div class="line">sudo usermod -a -G snodec root</div>
</div><!-- fragment --><p>As SNode.C uses C++ templates a lot, the compilation process will take some time. At least on a Raspberry Pi you can go for a coffee - it will take up to one and a half hour on a Raspberry Pi 3 if just one core is activated for compilation.</p>
<p>It is a good idea to utilize all processor cores and threads for compilation. Thus e.g. on a Raspberry Pi append <code>-j5</code> to the <code>make</code> or <code>ninja</code> command.</p>
<h2><a class="anchor" id="deploment-on-openwrt"></a>
Deploment on OpenWRT</h2>
<p>As a starting point, it is assumed that local <em>ssh</em> and <em>sftp</em> access to the router exist and that the router is connected to the Internet via the WAN port.</p>
<p>Deploying SNode.C on an OpenWRT router involves a view tasks:</p>
<ol type="1">
<li>Choose and download an OpenWRT-SDK</li>
<li>Patch the SDK to integrate the SNode.C feed</li>
<li>Install the SNode.C package and its dependencies</li>
<li>Configure the SDK</li>
<li>Cross compile SNode.C</li>
<li>Deploy SNode.C</li>
</ol>
<p>SNode.C needs to be <em>cross compiled</em> on a Linux host system to be deployable on OpenWRT. Don't be afraid about cross compiling it is strait forward.</p>
<h3><a class="anchor" id="choose-and-download-a-sdk"></a>
Choose and Download a SDK</h3>
<p>First, download and extract a SDK-package of version 23.05.0-rc1 or later from the <a href="https://downloads.openwrt.org/">OpenWRT download page</a> into an arbitrary directory &lt;DIR&gt;.</p>
<p>For example to download and use the SDK version 23.05.0-rc1 for the Netgear MR8300 Wireless Router (soc: IPQ4019) run</p>
<div class="fragment"><div class="line">cd &lt;DIR&gt;</div>
<div class="line">wget -qO - https://downloads.openwrt.org/releases/23.05.0-rc2/targets/ipq40xx/generic/openwrt-sdk-23.05.0-rc2-ipq40xx-generic_gcc-12.3.0_musl_eabi.Linux-x86_64.tar.xz | tar Jx</div>
</div><!-- fragment --><p>to create the SDK directory <code>openwrt-sdk-&lt;version&gt;-&lt;architecture&gt;-&lt;atype&gt;_&lt;compiler&gt;-&lt;cverstion&gt;_&lt;libc&gt;_&lt;abi&gt;.Linux-x86_64</code> what from now on is referred as &lt;SDK_DIR&gt;.</p>
<p>In this example the values of the placeholder are:</p>
<ul>
<li>&lt;version&gt; = 23.05.0-rc2</li>
<li>&lt;architecture&gt; = ipq40xx_</li>
<li>&lt;atype&gt; = generic</li>
<li>&lt;compiler&gt; = gcc</li>
<li>&lt;cverstion&gt; = 12.3.0</li>
<li>&lt;libc&gt; = musl</li>
<li>&lt;abi&gt; = eabi</li>
</ul>
<h3><a class="anchor" id="patch-the-sdk-to-integrate-the-snodec-feed"></a>
Patch the SDK to Integrate the SNode.C Feed</h3>
<p>Second step is to patch the default OpenWRT package feeds to add the SNode.C feed by executing</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;</div>
<div class="line">echo &quot;src-git snodec https://github.com/SNodeC/OpenWRT&quot; &gt;&gt; feeds.conf.default</div>
</div><!-- fragment --><h3><a class="anchor" id="install-the-snodec-package-and-its-dependencies"></a>
Install the SNode.C Package and its Dependencies</h3>
<p>In the third step, all source packages required to compile SNode.C are installed.</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;</div>
<div class="line">./scripts/feeds update base packages snodec # Only the feeds base, packages and snodec are necessary</div>
<div class="line">./scripts/feeds install snode.c</div>
</div><!-- fragment --><h3><a class="anchor" id="configure-the-sdk"></a>
Configure the SDK</h3>
<p>The SDK is configured in the fourth step.</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;</div>
<div class="line">make defconfig</div>
</div><!-- fragment --><p>Default values for all configuration options can be used safely.</p>
<p>Nevertheless, to customize the configuration run</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;</div>
<div class="line">make menuconfig</div>
</div><!-- fragment --><p>and navigate to <code>Network -&gt; SNode.C</code>.</p>
<h3><a class="anchor" id="cross-compile-snodec"></a>
Cross Compile SNode.C</h3>
<p>In the last step, SNode.C is cross-compiled.</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;</div>
<div class="line">make package/snode.c/compile</div>
</div><!-- fragment --><p>The two steps, <em>Install Packages</em>, and <em>Cross Compile</em> (at most the last one) take some time as</p>
<ol type="1">
<li>all feed and package definitions necessary to cross compile SNode.C are downloaded and installed locally from the OpenWRT servers and from github,</li>
<li>the sources of all dependent and indirect dependent packages are downloaded from upstream and build recursively and</li>
<li>SNode.C is cloned from github and cross compiled.</li>
</ol>
<p>To parallelize the compilation use the switch <code>-j&lt;thread-count&gt;</code> of <code>make</code> or <code>ninja</code> where &lt;thread-count&gt; is the number of CPU-threads dedicated to cross compile SNode.C and its dependencies.</p>
<p><em><b>Note:</b></em> For SNode.C and all it's build dependencies the created <em>ipk-packages</em> can be found in the directory <code>&lt;SDK_DIR&gt;bin/packages/\&lt;architecture\&gt;</code>.</p>
<h3><a class="anchor" id="deploy-snodec"></a>
Deploy SNode.C</h3>
<p>After cross compilation, SNode.C can be deployed.</p>
<p>The <code>snode.c-*_&lt;version&gt;_&lt;architecture&gt;.ipk</code> packages must be downloaded to and installed on the router by executing</p>
<div class="fragment"><div class="line">cd &lt;SDK_DIR&gt;/bin/packages/&lt;architecture&gt;/snodec</div>
<div class="line">sftp root@&lt;router-ip&gt;</div>
<div class="line">cd /tmp</div>
<div class="line">put snode.c-*_&lt;version&gt;_&lt;architecture&gt;.ipk</div>
<div class="line">exit</div>
<div class="line">ssh root@&lt;router-ip&gt;</div>
<div class="line">cd /tmp</div>
<div class="line">opkg [--force-reinstall] install snode.c-*_&lt;version&gt;_&lt;architecture&gt;.ipk</div>
<div class="line">exit</div>
</div><!-- fragment --><p>on the router. Use the option <code>--force-reinstall</code> in cast you want to reinstall the same version by overwriting the currently installed files.</p>
<p>During package installation a new <em>unix group</em> with member <em>root</em> is created, used for the group management of config-, log-, and pid-files.</p>
<p><em><b>Note:</b></em> A logout/login is necessary to activate the new group assignment.</p>
<h1><a class="anchor" id="design-decisions-and-features"></a>
Design Decisions and Features</h1>
<ul>
<li>Easy to use and extend</li>
<li>Clear and clean architecture</li>
<li>Single threaded, single tasking</li>
<li>Event driven</li>
<li>Layer based</li>
<li>Modular</li>
<li>Support for single shot and interval timer</li>
<li>Sophisticated configuration system controlled either by<ul>
<li>code (API),</li>
<li>command line</li>
<li>configuration file</li>
</ul>
</li>
<li>Daemonize (double fork) server and client if requested</li>
<li>Support for all three major multiplexer API's<ul>
<li>epoll</li>
<li>poll</li>
<li>select</li>
</ul>
</li>
<li>Support for five network protocols<ul>
<li>IPv4</li>
<li>IPv6 (single and dual stack)</li>
<li>Unix domain sockets</li>
<li>Bluetooth RFCOMM</li>
<li>Bluetooth L2CAP</li>
</ul>
</li>
<li>Sub-Frameworks<ul>
<li>HTTP/S server and client</li>
<li>High level HTTP/S server framework à la Node.js-Express</li>
<li>WebSocket (WS and WSS) for server and client</li>
<li>MQTT/S for server and client</li>
</ul>
</li>
<li>Micro library architecture<ul>
<li>Every individual feature/functionality is provided in its corresponding library</li>
<li>Each of these library <em>transitively</em> depends <em>subsequently</em> on all further required libraries</li>
</ul>
</li>
<li>Reference project: <a href="https://github.com/SNodeC/mqttsuite">MQTT-Suite</a><ul>
<li>mqttbroker (native and WebSocket),</li>
<li>mqttbridge (native and WebSocket),</li>
<li>mqttintegrator (native and WebSocket)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="fundamental-architecture"></a>
Fundamental Architecture</h1>
<p><img src="./docs/assets/README/BasicArchitectureEchoServerClient.png" alt="drawing" style="max-width: 100%;" class="inline"/> <em>The fundamental architecture by means of the EchoServer and EchoClient applications. <code>SCF</code> is an abbreviation for <code>SocketContextFactory</code></em></p>
<h2><a class="anchor" id="network-layer"></a>
Network Layer</h2>
<p>SNode.C currently supports five different network layer protocols, each living in it's own C++ namespace.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Internet Protocol version 4 (IPv4)   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in.html"><code>net::in</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Internet Protocol version 6 (IPv6)   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6.html"><code>net::in6</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un.html"><code>net::un</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth Radio Frequency Communication (RFCOMM)   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc.html"><code>net::rc</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth Logical Link Control and Adaptation Protocol (L2CAP)   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2.html"><code>net::l2</code></a>   </td></tr>
</table>
<p>Each network layer provides ready to use <code>SocketServer</code> and <code>SocketClient</code> classes for unencrypted and encrypted communication.</p>
<h2><a class="anchor" id="transport-layer"></a>
Transport Layer</h2>
<p>Currently only connection-oriented transports (<code>stream</code>) are implemented. For IPv4 and IPv6 this means TCP.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Transport   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Stream   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacecore_1_1socket_1_1stream.html">core::socket::stream</a>   </td></tr>
</table>
<p>This layer is implemented as template base classes which needs to be specialized for every network layer.</p>
<p>Though, typically the user didn't get in direct contact with this layer as the ready to use <code>SocketServer</code> and <code>SocketClient</code> classes handle the specialization internally.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Transport Layer Specializations   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream.html"><code>net::in::stream</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream.html"><code>net::in6::stream</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream.html"><code>net::un::stream</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream.html"><code>net::rc::stream</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream.html"><code>net::l2::stream</code></a>   </td></tr>
</table>
<p><em><b>Note</b></em>: All transport layer specializations provide a common <em>base API</em> which makes it very easy to create servers and clients for all of them.</p>
<h2><a class="anchor" id="connection-layer"></a>
Connection Layer</h2>
<p>The connection layer sits on top of the transport layer and is responsible for handling the <em>physical data exchange</em> and, in the case of a SSL/TLS-secured connection, for the <em>encryption</em> resp. <em>decryption</em>. A concrete <code>SocketContext</code> relies on it's methods (e.g. <code>sendToPeer()</code> and <code>readFromPeer()</code> ) for communication with the peer.</p>
<p>Two versions of this layer exist. One for <em>unencrypted</em> and one for <em>SSL/TLS-encrypted</em> communication.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Connection Type   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacecore_1_1socket_1_1stream_1_1legacy.html"><code>core::socket::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacecore_1_1socket_1_1stream_1_1tls.html"><code>core::socket::stream::tls</code></a>   </td></tr>
</table>
<p>Like the transport layer, this layer is implemented as template base classes which are specialized for every <em>specialized transport</em> layer. Thus, the user typically didn't get in direct contact with this layer also, as the ready to use <code>SocketServer</code> and <code>SocketClient</code> classes also handle the specialization internally.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Connection Layer Specializations   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4 unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1legacy.html"><code>net::in::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv4 encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1tls.html"><code>net::in::stream::tls</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv6 unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1legacy.html"><code>net::in6::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6 encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1tls.html"><code>net::in6::stream::tls</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1legacy.html"><code>net::un::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Unix Domain encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1tls.html"><code>net::un::stream::tls</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RFCOMM unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1legacy.html"><code>net::rc::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RFCOMM encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1tls.html"><code>net::rc::stream::tls</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">L2CAP unencrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1legacy.html"><code>net::l2::stream::legacy</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">L2CAP encrypted   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1tls.html"><code>net::l2::stream::tls</code></a>   </td></tr>
</table>
<ul>
<li>The SSL/TLS versions <em>transparently offers encryption</em> provided by OpenSSL for all transport layers and thus, also for all application protocols.<ul>
<li>Support of X.509 certificates</li>
<li>Server Name Indication (SNI) is supported (useful for e.g. virtual (web) servers)</li>
<li>Support for individual SNI certificates</li>
</ul>
</li>
<li>Each connection layer provides ready to use <code>SocketServer</code> and <code>SocketClient</code> classes.</li>
</ul>
<h2><a class="anchor" id="application-layer"></a>
Application Layer</h2>
<p>In-framework server and client support designed as sub-frameworks currently exist for the application level protocols</p>
<ul>
<li>HTTP/0.9/1.0/1.1</li>
<li>WebSocket version 13</li>
<li>MQTT version 3.1.1 (version 5.0 is in preparation)</li>
<li>MQTT via WebSockets</li>
<li>High-Level web API layer with JSON support very similar to the API of node.js/express.</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Application Layer   </th><th class="markdownTableHeadNone">C++ Namespace    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HTTP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespaceweb_1_1http.html"><code>web::http</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WebSocket   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespaceweb_1_1websocket.html"><code>web::websocket</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Express   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespaceexpress.html"><code>express</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MQTT   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespaceiot_1_1mqtt.html"><code>iot::mqtt</code></a>   </td></tr>
</table>
<h1><a class="anchor" id="existing-socketserver-and-socketclient-classes"></a>
Existing <code>SocketServer</code> and <code>SocketClient</code> Classes</h1>
<p>Before focusing explicitly on the <em>SocketServer</em> and <em>SocketClient</em> classes a few common aspects for all network/transport-layer combinations needs to be known.</p>
<h2><a class="anchor" id="common-aspects-of-socketserver-and-socketclient-classes"></a>
Common Aspects of <code>SocketServer</code> and <code>SocketClient</code> Classes</h2>
<h3><a class="anchor" id="socketaddress"></a>
<code>SocketAddress</code></h3>
<p>Every network layer provides its specific <code>SocketAddress</code> class. In typical scenarios you need not bother about these classes as objects of it are managed internally by the framework.</p>
<p>Nevertheless, for the sake of completeness, all currently supported <code>SocketAddress</code> classes along with the header files they are declared in are listed below.</p>
<p>Every <code>SocketServer</code> and <code>SocketClient</code> class has it's specific <code>SocketAddress</code> type attached as nested data type. Thus, one can always get the correct <code>SocketAddress</code> type buy just</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>SocketAddress = &lt;ConcreteServerOrClientType&gt;::SocketAddress;</div>
</div><!-- fragment --><p>as can be seen in the <a class="el" href="#an-echo-application">Echo Application</a> above.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone"><em>SocketAddress</em> Classes   </th><th class="markdownTableHeadNone">SocketAddress Header Files    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1in_1_1SocketAddress.html"><code>net::in::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in_2SocketAddress_8h.html"><code>net/in/SocketAddress.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1in6_1_1SocketAddress.html"><code>net::in6::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in6_2SocketAddress_8h.html"><code>net/in6/SocketAddress.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1un_1_1SocketAddress.html"><code>net::un::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2un_2SocketAddress_8h.html"><code>net/un/SocketAddress.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1rc_1_1SocketAddress.html"><code>net::rc::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2rc_2SocketAddress_8h.html"><code>net/rc/SocketAddress.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1l2_1_1SocketAddress.html"><code>net::l2::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2l2_2SocketAddress_8h.html"><code>net/l2/SocketAddress.h</code></a>   </td></tr>
</table>
<p>Each <em>SocketAddress</em> class provides it's very specific set of constructors.</p>
<h4><a class="anchor" id="socketaddress-constructors"></a>
<code>SocketAddress</code> Constructors</h4>
<p>The default constructors of all <code>SocketAddress</code> classes creates wild-card <code>SocketAddress</code> objects. For a <code>SocketClient</code> for example, which uses such a wild-card <code>SocketAddress</code> as <em>local address</em> the operating system chooses a valid <code>sockaddr</code> structure for the local side of the connection automatically.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">SocketAddress   </th><th class="markdownTableHeadNone">Constructors    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1in_1_1SocketAddress.html"><code>net::in::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><code>SocketAddress()</code>;<br  />
<code>SocketAddress(uint16_t port)</code>;<br  />
<code>SocketAddress(const std::string&amp; ipOrHostname)</code>;<br  />
<code>SocketAddress(const std::string&amp; ipOrHostname, uint16_t port)</code>;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1in6_1_1SocketAddress.html"><code>net::in6::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><code>SocketAddress()</code>;<br  />
<code>SocketAddress(uint16_t port)</code>;<br  />
<code>SocketAddress(const std::string&amp; ipOrHostname)</code>;<br  />
<code>SocketAddress(const std::string&amp; ipOrHostname, uint16_t port)</code>;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1un_1_1SocketAddress.html"><code>net::un::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><code>SocketAddress()</code>;<br  />
<code>SocketAddress(const std::string&amp; sunPath)</code>;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1rc_1_1SocketAddress.html"><code>net::rc::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><code>SocketAddress()</code>;<br  />
<code>SocketAddress(uint8_t channel)</code>;<br  />
<code>SocketAddress(const std::string&amp; btAddress)</code>;<br  />
<code>SocketAddress(const std::string&amp; btAddress, uint8_t channel)</code>;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classnet_1_1l2_1_1SocketAddress.html"><code>net::l2::SocketAddress</code></a>   </td><td class="markdownTableBodyNone"><code>SocketAddress()</code>;<br  />
<code>SocketAddress(uint16_t psm)</code>;<br  />
<code>SocketAddress(const std::string&amp; btAddress)</code>;<br  />
<code>SocketAddress(const std::string&amp; btAddress, uint16_t psm)</code>;   </td></tr>
</table>
<h3><a class="anchor" id="socketconnection"></a>
<code>SocketConnection</code></h3>
<p>Every network layer uses its specific <code>SocketConnection</code> class. Such a <code>SocketConnection</code> object represents the physical connection to the peer and is a specialization of one of the two template classes</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Encryption   </th><th class="markdownTableHeadNone">SocketConnection Classes   </th><th class="markdownTableHeadNone">SocketConnection Header Files    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Legacy   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classcore_1_1socket_1_1stream_1_1legacy_1_1SocketConnection.html"><code>core::socket::stream::legacy::SocketConnection</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/legacy_2SocketConnection_8h.html"><code>core/socket/stream/legacy/SocketConnection.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SSL/TLS   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/classcore_1_1socket_1_1stream_1_1tls_1_1SocketConnection.html"><code>core::socket::stream::tls::SocketConnection</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/tls_2SocketConnection_8h.html"><code>core/socket/stream/tls/SocketConnection.h</code></a>   </td></tr>
</table>
<p>which itself are derived from the abstract non template base class <code><a class="el" href="classcore_1_1socket_1_1stream_1_1SocketConnection.html">core::socket::stream::SocketConnection</a></code>.</p>
<p>Equivalent to the <code>SocketAddress</code> type, each <code>SocketServer</code> and <code>SocketClient</code> class provides its correct <code>SocketConnection</code> type as nested data type. This type can be obtained from a concrete <code>SocketServer</code> or <code>SocketClient</code> class using</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>SocketConnection = &lt;ConcreteServerOrClientType&gt;::SocketConnection;</div>
</div><!-- fragment --><p>Each <code>SocketConnection</code> object provides, among others, the method <code>int getFd()</code> which returns the underlying descriptor used for communication.</p>
<p>Additionally the encrypting <code>SocketConnection</code> objects provide the method <code>SSL* getSSL()</code> which returns a pointer to the <code>SSL</code> structure of <em>OpenSSL</em> used for encryption, authenticating and authorization. Using this <code>SSL</code> structure one can modify the SSL/TLS behavior before the SSL/TLS handshake takes place in the <a class="el" href="#the-onconnect-callback">`onConnect` callback</a>, discussed below, and add all kinds of authentication and authorization logic directly in the <a class="el" href="#the-onconnected-callback">`onConnected` callback</a>, also discussed below.</p>
<h4><a class="anchor" id="most-important-common-socketconnection-methods"></a>
Most Important common <code>SocketConnection</code> Methods</h4>
<ul>
<li><p class="startli">Get the unserlying descriptor used for communication.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> getFd();</div>
</div><!-- fragment --></li>
<li><p class="startli">Get the pointer to OpenSSL's <code>SSL</code> structure.</p>
<div class="fragment"><div class="line">SSL* getSSL();</div>
</div><!-- fragment --></li>
<li><p class="startli">Enqueue data to be send to the peer.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> sendToPeer(<span class="keyword">const</span> <span class="keywordtype">char</span>* junk, std::size_t junkLen);</div>
<div class="line"><span class="keywordtype">void</span> sendToPeer(<span class="keyword">const</span> std::string&amp; data);</div>
<div class="line"><span class="keywordtype">void</span> sendToPeer(<span class="keyword">const</span> std::vector&lt;char&gt;&amp; data);</div>
<div class="line"><span class="keywordtype">void</span> sendToPeer(<span class="keyword">const</span> std::vector&lt;int8_t&gt;&amp; data);</div>
</div><!-- fragment --></li>
<li><p class="startli">Read already received data from peer.</p>
<div class="fragment"><div class="line">std::size_t readFromPeer(<span class="keywordtype">char</span>* junk, std::size_t junkLen);</div>
</div><!-- fragment --></li>
<li><p class="startli">Shut down socket either for reading or writing. If <code>forceClose</code> is <code>true</code> the reading end will also be shut down.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> shutdownRead();</div>
<div class="line"><span class="keywordtype">void</span> shutdownWrite(<span class="keywordtype">bool</span> forceClose = <span class="keyword">false</span>);</div>
</div><!-- fragment --></li>
<li><p class="startli">Hard close the connection without a prior shutdown.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> close();</div>
</div><!-- fragment --></li>
<li><p class="startli">Set the inactivity timeout of a connection (default 60 seconds). If no data has been transfered within this amount of time the connection is terminated.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setTimeout(<a class="code hl_class" href="classutils_1_1Timeval.html">utils::Timeval</a>&amp; timeout);</div>
<div class="ttc" id="aclassutils_1_1Timeval_html"><div class="ttname"><a href="classutils_1_1Timeval.html">utils::Timeval</a></div><div class="ttdef"><b>Definition</b> <a href="Timeval_8h_source.html#l00058">Timeval.h:58</a></div></div>
</div><!-- fragment --></li>
<li><p class="startli">Check if a connection has been created successfully.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> isValid();</div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="constructors-of-socketserver-and-socketclient-classes"></a>
Constructors of <code>SocketServer</code> and <code>SocketClient</code> Classes</h3>
<p>Beside the already discussed constructors of the <code>SocketServer</code> and <code>SocketClient</code> classes, each of them provides additional constructors which expect three callback <code>std::function</code> objects as arguments.</p>
<p>This callback functions are called by SNode.C during connection establishment and connection shutdown between server and clients.</p>
<p>The constructors also accepts an optional template parameter pack which is passed on to the used <code>SocketContextFactory</code> as arguments.</p>
<p>Thus, the full lists of constructors of the <code>SocketServer</code> and <code>SocketClient</code> classes are:</p>
<h4><a class="anchor" id="all-constructors-of-socketserver-classes"></a>
All Constructors of <code>SocketServer</code> Classes</h4>
<div class="fragment"><div class="line">SocketServer(<span class="keyword">const</span> std::string&amp; instanceName,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onConnect,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onConnected,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onDisconnect,</div>
<div class="line">             Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketServer(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onConnect,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onConnected,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketServer::SocketConnection*)&gt;&amp; onDisconnect,</div>
<div class="line">             Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketServer(<span class="keyword">const</span> std::string&amp; instanceName, Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketServer(<span class="keyword">const</span> Args&amp;&amp;);</div>
</div><!-- fragment --><h4><a class="anchor" id="all-constructors-of-socketclient-classes"></a>
All Constructors of <code>SocketClient</code> Classes</h4>
<div class="fragment"><div class="line">SocketClient(<span class="keyword">const</span> std::string&amp; instanceName,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onConnect,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onConnected,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onDisconnect,</div>
<div class="line">             Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketClient(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onConnect,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onConnected,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(SocketClient::SocketConnection*)&gt;&amp; onDisconnect,</div>
<div class="line">             Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketClient(<span class="keyword">const</span> std::string&amp; instanceName, Args&amp;&amp;... args);</div>
<div class="line"> </div>
<div class="line">SocketClient(Args&amp;&amp;... args);</div>
</div><!-- fragment --><h3><a class="anchor" id="constructor-callbacks"></a>
Constructor Callbacks</h3>
<p><em><b>Important</b></em>: Do not confuse these callbacks with the overridden <code>onConnected</code> and <code>onDisconnected</code> methods of a <code>SocketContext</code> as these virtual methods are called in case a <code>SocketContext</code> object has been created successfully or before it is being destroyed.</p>
<p>All three callbacks expect a pointer to a <code>SocketConnection</code> object as argument. This <code>SocketConnection</code> can be used to modify all aspects of a connection.</p>
<h4><a class="anchor" id="the-onconnect-callback"></a>
The <code>onConnect</code> Callback</h4>
<p>This callback is called after a connection oriented connection has been created successful.</p>
<p>For a <code>SocketServer</code> this means after a successful internal call to <code>accept()</code> and for a <code>SocketClient</code> after a successful internal call to <code>connect()</code></p>
<p>This does not necessarily mean that the connection is ready for communication. Especially in case of a SSL/TLS connection the <em>initial handshake has not yet been done</em>.</p>
<h4><a class="anchor" id="the-onconnected-callback"></a>
The <code>onConnected</code> Callback</h4>
<p>This callback is called after the connection has been fully established and is <em>ready for communication</em>. In case of a SSL/TLS connection the <em>initial handshake has been finished</em> successfully.</p>
<p>In case of a legacy connection <code>onConnected</code> is called immediately after <code>onConnect</code> because no additional handshake needs to be done.</p>
<h4><a class="anchor" id="the-ondisconnected-callback"></a>
The <code>onDisconnected</code> Callback</h4>
<p>As the name suggests this callback is executed after a connection to the peer has been shut down.</p>
<h4><a class="anchor" id="attaching-the-callbacks-during-instance-creation"></a>
Attaching the Callbacks during Instance Creation</h4>
<p>For a concrete <code>SocketServer</code> instance (here an anonymous instance) the constructors expecting callbacks can be used like</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoServer = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoServer::SocketAddress;</div>
<div class="line"><span class="keyword">using </span>SocketConnection = EchoServer::SocketConnection;</div>
<div class="line"> </div>
<div class="line">EchoServer echoServer([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer estableshed&quot;</span>;</div>
<div class="line">                      },</div>
<div class="line">                      [] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer ready to be used&quot;</span>;</div>
<div class="line">                      },</div>
<div class="line">                      [] (<a class="code hl_typedef" href="namespaceapps_1_1http_1_1legacy.html#a30976a44df49fb6d754fc5db457052ea">SocketConnection</a>* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer closed&quot;</span>;</div>
<div class="line">                      });</div>
<div class="line"> </div>
<div class="line">echoServer.listen(...);</div>
<div class="ttc" id="anamespaceapps_1_1http_1_1legacy_html_a30976a44df49fb6d754fc5db457052ea"><div class="ttname"><a href="namespaceapps_1_1http_1_1legacy.html#a30976a44df49fb6d754fc5db457052ea">apps::http::legacy::SocketConnection</a></div><div class="ttdeci">Client::SocketConnection SocketConnection</div><div class="ttdef"><b>Definition</b> <a href="http_2model_2clients_8h_source.html#l00088">clients.h:88</a></div></div>
</div><!-- fragment --><p>and for a concrete <code>SocketClient</code> class like</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoClient = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoClientContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoClient::SocketAddress;</div>
<div class="line"><span class="keyword">using </span>SocketConnection = EchoClient::SocketConnection;</div>
<div class="line"> </div>
<div class="line">EchoClient echoClient([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer estableshed&quot;</span>;</div>
<div class="line">                      },</div>
<div class="line">                      [] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer ready to be used&quot;</span>;</div>
<div class="line">                      },</div>
<div class="line">                      [] (<a class="code hl_typedef" href="namespaceapps_1_1http_1_1legacy.html#a30976a44df49fb6d754fc5db457052ea">SocketConnection</a>* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">                          VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer closed&quot;</span>;</div>
<div class="line">                      });</div>
<div class="line"> </div>
<div class="line">echoClient.connect(...);</div>
</div><!-- fragment --><h4><a class="anchor" id="attaching-the-callbacks-to-already-existing-instances"></a>
Attaching the Callbacks to already existing Instances</h4>
<p>In case <code>SocketServer</code> and <code>SocketClient</code> instances have been created using a constructor not expecting those three callbacks they can be attached to this instances afterwards by using the methods</p>
<ul>
<li><code>void setOnConnect(const std::function&lt;SocketConnection*&gt;&amp; onConnect)</code></li>
<li><code>void setOnConnected(const std::function&lt;SocketConnection*&gt;&amp; onConnected)</code></li>
<li><code>void setOnDisconnected(const std::function&lt;SocketConnection*&gt;&amp; onDisconnected)</code></li>
</ul>
<p>like for example</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoServer = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoServer::SocketAddress;</div>
<div class="line"><span class="keyword">using </span>SocketConnection = EchoServer::SocketConnection;</div>
<div class="line"> </div>
<div class="line">EchoServer echoServer;</div>
<div class="line"> </div>
<div class="line">echoServer.setOnConnect([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer established&quot;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">echoServer.setOnConnected([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer ready to be used&quot;</span>;</div>
<div class="line">});</div>
<div class="line">    </div>
<div class="line">echoServer.setOnDisconnected([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer closed&quot;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">echoServer.listen(...);</div>
</div><!-- fragment --><p>and</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoClient = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoClientContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoClient::SocketAddress;</div>
<div class="line"><span class="keyword">using </span>SocketConnection = EchoClient::SocketConnection;</div>
<div class="line"> </div>
<div class="line">EchoClient echoClient;</div>
<div class="line"> </div>
<div class="line">echoClient.setOnConnect([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer established&quot;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">echoClient.setOnConnected([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer ready to be used&quot;</span>;</div>
<div class="line">});</div>
<div class="line">    </div>
<div class="line">echoClient.setOnDisconnected([] (SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    VLOG(1) &lt;&lt; <span class="stringliteral">&quot;Connection to peer closed&quot;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">echoClient.connect(...);</div>
</div><!-- fragment --><h2><a class="anchor" id="socketserver-classes"></a>
<code>SocketServer</code> Classes</h2>
<p>Each <code>SocketServer</code> template class expects a concrete <code>SocketContextFactory</code> as template argument. This mandatory template argument is hidden in the following <code>SocketServer</code> types table.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">Legacy Types   </th><th class="markdownTableHeadNone">SSL/TLS Types    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1legacy.html"><code>net::in::stream::legacy::SocketServer</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1tls.html"><code>net::in::stream::tls::SocketServer</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1legacy.html"><code>net::in6::stream::legacy::SocketServer</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1tls.html"><code>net::in6::stream::tls::SocketServer</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1legacy.html"><code>net::un::stream::legacy::SocketServer</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1tls.html"><code>net::un::stream::tls::SocketServer</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1legacy.html"><code>net::rc::stream::legacy::SocketServer</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1tls.html"><code>net::rc::stream::tls::SocketServer</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1legacy.html"><code>net::l2::stream::legacy::SocketServer</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1tls.html"><code>net::l2::stream::tls::SocketServer</code></a>   </td></tr>
</table>
<h3><a class="anchor" id="socketserver-header-files"></a>
<code>SocketServer</code> Header Files</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">Legacy Header Files   </th><th class="markdownTableHeadNone">SSL/TLS Header Files    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in_2stream_2legacy_2SocketServer_8h.html"><code>net/in/stream/legacy/SocketServer.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in_2stream_2tls_2SocketServer_8h.html"><code>net/in/stream/tls/SocketServer.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in6_2stream_2legacy_2SocketServer_8h.html"><code>net/in6/stream/legacy/SocketServer.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in6_2stream_2tls_2SocketServer_8h.html"><code>net/in6/stream/tls/SocketServer.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2un_2stream_2legacy_2SocketServer_8h.html"><code>net/un/stream/legacy/SocketServer.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2un_2stream_2tls_2SocketServer_8h.html"><code>net/un/stream/tls/SocketServer.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2rc_2stream_2legacy_2SocketServer_8h.html"><code>net/rc/stream/legacy/SocketServer.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2rc_2stream_2tls_2SocketServer_8h.html"><code>net/rc/stream/tls/SocketServer.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2l2_2stream_2legacy_2SocketServer_8h.html"><code>net/l2/stream/legacy/SocketServer.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2l2_2stream_2tls_2SocketServer_8h.html"><code>net/l2/stream/tls/SocketServer.h</code></a>   </td></tr>
</table>
<h3><a class="anchor" id="listen-methods"></a>
Listen Methods</h3>
<p>As already mentioned, for convenience each <code>SocketServer</code> class provides its own specific set of <code>listen()</code> methods. The implementation of this methods rely on some <code>listen()</code> methods common to all <code>SocketServer</code> classes.</p>
<p>All <code>listen()</code> methods expect a <em>status callback</em> as argument which is called in case the socket has been created and switched into the listen state or an error has occurred. The signature of this callback is</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::function&lt;void(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state)&gt;</div>
</div><!-- fragment --><p>The local (bound) <code>SocketAddress</code> and a <code>state</code> object is passed to this callback as arguments.</p>
<h4><a class="anchor" id="socketaddress-types"></a>
<code>SocketAddress</code> Types</h4>
<p>The type of the <code>SocketAddress</code> needs to match with the type of the <code>SocketServer</code> and can be acquired from a concrete <code>SocketServer</code> type by</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>SocketAddress = &lt;ConcreteSocketServerType&gt;::SocketAddress;</div>
</div><!-- fragment --><h4><a class="anchor" id="the-coresocketstate-object"></a>
The <code>core::socket::State</code> Object</h4>
<p>The <code>const <a class="el" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state</code> object passed to the callback reports the status of the <code>SocketServer</code>. It can</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a></div>
</div><!-- fragment --><p>The <code>ServerSocket</code> instance has been created successfully and is ready for accepting incoming client connections.</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a></div>
</div><!-- fragment --><p>The <code>ServerSocket</code> instance is disabled</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a></div>
</div><!-- fragment --><p>During switching to the listening state a recoverable error has occurred. In case a <em>retry</em> is configured for this instance the listen attempt is retried automatically.</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a></div>
</div><!-- fragment --><p>A nonee recoverable error has occurred. No listen-retry is done.</p>
<h4><a class="anchor" id="common-listen-methods"></a>
Common <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> SocketAddress&amp; localAddress,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> SocketAddress&amp; localAddress,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="ipv4-specific-listen-methods"></a>
IPv4 specific <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(uint16_t port,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(uint16_t port,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">            uint16_t port,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">            uint16_t port,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="ipv6-specific-listen-methods"></a>
IPv6 specific <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(uint16_t port,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(uint16_t port,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">            uint16_t port,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">            uint16_t port,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="unix-domain-socket-specific-listen-methods"></a>
Unix Domain Socket specific <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; sunPath,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; sunPath,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="bluetooth-rfcomm-specific-listen-methods"></a>
Bluetooth RFCOMM specific <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(uint8_t channel,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(uint8_t channel,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">            uint8_t channel,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">            uint8_t channel,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="bluetooth-l2cap-specific-listen-methods"></a>
Bluetooth L2CAP specific <code>listen()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> listen(uint16_t psm,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(uint16_t psm,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">            uint16_t psm,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> listen(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">            uint16_t psm,</div>
<div class="line">            <span class="keywordtype">int</span> backlog,</div>
<div class="line">            <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h2><a class="anchor" id="socketclient-classes"></a>
<code>SocketClient</code> Classes</h2>
<p>Each <code>SocketClient</code> template class expects a concrete <code>SocketContextFactory</code> as template argument. This mandatory template argument is hidden in the following <code>SocketClient</code> types table.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">Legacy Types   </th><th class="markdownTableHeadNone">SSL/TLS Types    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1legacy.html"><code>net::in::stream::legacy::SocketClient</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1tls.html"><code>net::in::stream::tls::SocketClient</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1legacy.html"><code>net::in6::stream::legacy::SocketClient</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1tls.html"><code>net::in6::stream::tls::SocketClient</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1legacy.html"><code>net::un::stream::legacy::SocketClient</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1tls.html"><code>net::un::stream::tls::SocketClient</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1legacy.html"><code>net::rc::stream::legacy::SocketClient</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1tls.html"><code>net::rc::stream::tls::SocketClient</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1legacy.html"><code>net::l2::stream::legacy::SocketClient</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1tls.html"><code>net::l2::stream::tls::SocketClient</code></a>   </td></tr>
</table>
<h3><a class="anchor" id="socketclient-header-files"></a>
<code>SocketClient</code> Header Files</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">Legacy Header Files   </th><th class="markdownTableHeadNone">SSL/TLS Header Files    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in_2stream_2legacy_2SocketClient_8h.html"><code>net/in/stream/legacy/SocketClient.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in_2stream_2tls_2SocketClient_8h.html"><code>net/in/stream/tls/SocketClient.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in6_2stream_2legacy_2SocketClient_8h.html"><code>net/in6/stream/legacy/SocketClient.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2in6_2stream_2tls_2SocketClient_8h.html"><code>net/in6/stream/tls/SocketClient.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2un_2stream_2legacy_2SocketClient_8h.html"><code>net/un/stream/legacy/SocketClient.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2un_2stream_2tls_2SocketClient_8h.html"><code>net/un/stream/tls/SocketClient.h</code></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2rc_2stream_2legacy_2SocketClient_8h.html"><code>net/rc/stream/legacy/SocketClient.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2rc_2stream_2tls_2SocketClient_8h.html"><code>net/rc/stream/tls/SocketClient.h</code></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetooth L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2l2_2stream_2legacy_2SocketClient_8h.html"><code>net/l2/stream/legacy/SocketClient.h</code></a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/net_2l2_2stream_2tls_2SocketClient_8h.html"><code>net/l2/stream/tls/SocketClient.h</code></a>   </td></tr>
</table>
<h3><a class="anchor" id="connect-methods"></a>
Connect Methods</h3>
<p>As already mentioned above, for convenience each <code>SocketClient</code> class provides its own specific set of connect methods. The implementation of this specific connect methods rely on some connect methods common to all <code>SocketClient</code> classes.</p>
<p>All <code>connect()</code> methods expect a <em>status callback</em> as argument which is called in case the socket has been created and connected to the peer or an error has occurred. The signature of this callback is</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::function&lt;void(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus)&gt;</div>
</div><!-- fragment --><p>The peers <code>SocketAddress</code> and a <code>state</code> value is passed to this callback as arguments.</p>
<h4><a class="anchor" id="socketaddress-types-1"></a>
<code>SocketAddress</code> Types</h4>
<p>The type of the <code>SocketAddress</code> needs to match with the type of the <code>SocketClient</code> and can be acquired from a concrete <code>SocketClient</code> type by</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>SocketAddress = &lt;ConcreteSocketClientType&gt;::SocketAddress;</div>
</div><!-- fragment --><h4><a class="anchor" id="the-coresocketstate-object-1"></a>
The <code>core::socket::State</code> Object</h4>
<p>The <code>const <a class="el" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state</code> value passed to the callback reports the status of the <code>SocketServer</code>.</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a></div>
</div><!-- fragment --><p>The <code>ClientSocket</code> instance has been created and connected to the peer successfully.</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a></div>
</div><!-- fragment --><p>The <code>ClientSocket</code> instance is disabled</p>
<div class="fragment"><div class="line">state == <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a></div>
</div><!-- fragment --><p>During switching to the connected state a recoverable error has occurred. In case a <em>retry</em> is configured for this instance the connect attempt is retried automatically.</p>
<div class="fragment"><div class="line">state == core::socket::State::FATAL</div>
</div><!-- fragment --><p>A non recoverable error has occurred. No connect-retry is done.</p>
<h4><a class="anchor" id="common-connect-methods"></a>
Common <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> SocketAddress&amp; remoteAddress,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> SocketAddress&amp; remoteAddress,</div>
<div class="line">             <span class="keyword">const</span> SocketAddress&amp; localAddress,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="ipv4-specific-connect-methods"></a>
IPv4 specific <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             uint16_t bindPort,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindIpOrHostname,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindIpOrHostname,</div>
<div class="line">             uint16_t bindPort,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="ipv6-specific-connect-methods"></a>
IPv6 specific <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             uint16_t bindPort,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindIpOrHostname,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; ipOrHostname,</div>
<div class="line">             uint16_t port,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindIpOrHostname,</div>
<div class="line">             uint16_t bindPort,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="unix-domain-socket-specific-connect-methods"></a>
Unix Domain Socket specific <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; sunPath,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; sunPath,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindSunPath,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="bluetooth-rfcomm-specific-connect-methods"></a>
Bluetooth RFCOMM specific <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint8_t channel,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint8_t channel,</div>
<div class="line">             uint8_t bindChannel,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint8_t channel,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindBtAddress,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint8_t channel,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindBtAddress,</div>
<div class="line">             uint8_t bindChannel,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h4><a class="anchor" id="bluetooth-l2cap-specific-connect-methods"></a>
Bluetooth L2CAP specific <code>connect()</code> Methods</h4>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint16_t psm,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint16_t psm,</div>
<div class="line">             uint16_t bindPsm,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint16_t psm,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindBtAddress,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> connect(<span class="keyword">const</span> std::string&amp; btAddress,</div>
<div class="line">             uint16_t psm,</div>
<div class="line">             <span class="keyword">const</span> std::string&amp; bindBtAddress,</div>
<div class="line">             uint16_t bindPsm,</div>
<div class="line">             <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus);</div>
</div><!-- fragment --><h1><a class="anchor" id="configuration"></a>
Configuration</h1>
<p>Each <code>SocketServer</code> and <code>SocketClient</code> instance needs to be configured before they can be started by the SNode.C event loop. Fore instance, a IPv4/TCP <code>SocketServer</code> needs to know at least the port number it should listen on and a IPv4/TCP <code>SocketClient</code> needs to now the host name or the IPv4 address and the port number a server is listening on. And if a SSL/TLS instance is used certificates are necessary for successful encryption.</p>
<p>There are many more configuration items but lets focus on those mentioned above.</p>
<h2><a class="anchor" id="three-different-options-for-configuration"></a>
Three different Options for Configuration</h2>
<p>SNode.C provides three different options to specify such configuration items. Nevertheless, internally all uses the same underlying configuration system, which is based on the great <a href="https://github.com/CLIUtils/CLI11">CLI11: Command line parser for C++11</a> library.</p>
<p>The configuration can either be done via</p>
<ul>
<li>the provided C++ API directly in the source code for anonymous and named instances</li>
<li>configuration files and</li>
<li>command line arguments for named instances</li>
</ul>
<p><b>Important:</b> Command line configuration takes precedence over configuration file configuration, which in turn takes precedence over C++ API configuration.</p>
<p><b>Important:</b> Command line and configuration file options are available and valid for server and client instances created before calling <code>core::SnodeC::start()</code>. For subsequently created instances, configuration can only be done using the C++ API.</p>
<h3><a class="anchor" id="configuration-using-the-c-api"></a>
Configuration using the C++ API</h3>
<p>Each <code>SocketServer</code> and <code>SocketClient</code> instance provide a configuration object which could be obtained by calling the method <code>getConfig()</code> on the instance, which returns a reference to that configuration object.</p>
<p>For the <code>EchoServer</code> instance from the <a class="el" href="#quick-starting-guide">Quick Starting Guide</a> section for example the configuration object can be obtained by just using</p>
<div class="fragment"><div class="line">EchoServer echoServer;</div>
<div class="line">echoServer.getConfig();</div>
</div><!-- fragment --><p>Such a configuration object provides many methods to specify the individual configuration items.</p>
<p>Thus, to configure the port number for the <code>echoServer</code> instance the method <code>setPort(uint16_t port)</code> of the configuration object can be used</p>
<div class="fragment"><div class="line">EchoServer echoServer;</div>
<div class="line">echoServer.getConfig().setPort(8001);</div>
</div><!-- fragment --><p>This is what the <code>listen()</code> method which expects a port number as argument does automatically.</p>
<p>Thus, if the port number is configured by using <code>setPort()</code> the <code>listen()</code> method which only takes a <code>std::function</code> as argument can be use and the <code>EchoServer</code> could also be started by</p>
<div class="fragment"><div class="line">EchoServer echoServer;</div>
<div class="line">echoServer.getConfig().setPort(8001);</div>
<div class="line"> </div>
<div class="line">echoServer.listen([](</div>
<div class="line">    <span class="keyword">const</span> SocketAddress&amp; socketAddress,</div>
<div class="line">    <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state)&gt;&amp; onStatus) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">);</div>
</div><!-- fragment --><p>The same technique can be used to configure the <code>EchoClient</code> instance.</p>
<p>Though, because a <code>SocketClient</code> has two independent sets of IP-Addresses/host names and port numbers, one for the remote side and one for the local side, one need to be more specific in which of these addresses shall be configured. Here the remote address is configured explicitly.</p>
<div class="fragment"><div class="line">EchoServer echoClient;</div>
<div class="line">echoClient.getConfig().Remote::setIpOrHostname(<span class="stringliteral">&quot;localhost&quot;</span>);</div>
<div class="line">echoClient.getConfig().Remote::setPort(8001);</div>
<div class="line"> </div>
<div class="line">echoClient.connect([](</div>
<div class="line">    <span class="keyword">const</span> SocketAddress&amp; socketAddress,</div>
<div class="line">    <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp;)&gt;&amp; onStatus) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">);</div>
</div><!-- fragment --><p>Other configuration items can be configured in the very same way but for most option items sane default values are already predefined.</p>
<h4><a class="anchor" id="list-of-all-configuration-items"></a>
List of all Configuration Items</h4>
<p>All <code>SocketServer</code> and <code>SocketClient</code> instances share some common <a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1config.html">configuration options</a>.</p>
<p>Network layer specific configuration options:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Network Layer   </th><th class="markdownTableHeadNone">SocketAddress   </th><th class="markdownTableHeadNone">Transport Layer   </th><th class="markdownTableHeadNone">Legacy Connection Layer   </th><th class="markdownTableHeadNone">TLS Connection Layer    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IPv4   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1config.html">Address configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1config.html">Transport layer configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1legacy_1_1config.html">Legacy configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in_1_1stream_1_1tls_1_1config.html">TLS configuration</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IPv6   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1config.html">Address configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1config.html">Transport layer configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1legacy_1_1config.html">Legacy configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1in6_1_1stream_1_1tls_1_1config.html">TLS configuration</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unix Domain Sockets   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1config.html">Address configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1config.html">Transport layer configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1legacy_1_1config.html">Legacy configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1un_1_1stream_1_1tls_1_1config.html">TLS configuration</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Bluetooth RFCOMM   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1config.html">Address configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1config.html">Transport layer configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1legacy_1_1config.html">Legacy configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1rc_1_1stream_1_1tls_1_1config.html">TLS configuration</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Bluetoot L2CAP   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1config.html">Address configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1config.html">Transport layer configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1legacy_1_1config.html">Legacy configuration</a>   </td><td class="markdownTableBodyNone"><a href="https://snodec.github.io/snode.c-doc/html/namespacenet_1_1l2_1_1stream_1_1tls_1_1config.html">TLS configuration</a>   </td></tr>
</table>
<h3><a class="anchor" id="configuration-via-the-command-line"></a>
Configuration via the Command Line</h3>
<p>Each <em>application</em> as such gets a set of command line options which control the behavior of the application in general. An overview of those option can be printed on screen by adding <code>--help</code> on the command line.</p>
<h4><a class="anchor" id="application-configuration"></a>
Application Configuration</h4>
<p>In case of the <code>EchoServer</code> demo application</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver --help</div>
</div><!-- fragment --><p>leads to the help output</p>
<div class="fragment"><div class="line">Configuration for Application &#39;echoserver&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver [OPTIONS]</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -c,--config-file configfile:NOT DIR [/home/&lt;user&gt;/.config/snode.c/echoserver.conf] </div>
<div class="line">       Read a config file</div>
<div class="line">  -w,--write-config [configfile]:NOT DIR [/home/&lt;user&gt;/.config/snode.c/echoserver.conf] </div>
<div class="line">       Write config file and exit</div>
<div class="line">  -k,--kill</div>
<div class="line">       Kill running daemon</div>
<div class="line">  -i,--instance-alias instance=instance_alias [instance=instance_alias [...]] </div>
<div class="line">       Make an instance also known as an alias in a configuration files</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all required and non-default options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  --version</div>
<div class="line">       Framework version</div>
<div class="line">  -h{standard},--help{standard}={standard,expanded} </div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  -l,--log-level level:INT in [0 - 6] [4]   </div>
<div class="line">       Log level</div>
<div class="line">  -v,--verbose-level level:INT in [0 - 10] [1]   </div>
<div class="line">       Verbose level</div>
<div class="line">  -q{true},-u{false},--quiet{true}={true,false} [false]   </div>
<div class="line">       Quiet mode</div>
<div class="line">  --log-file logfile:NOT DIR [/home/voc/.local/log/snode.c/echoserver.log]   </div>
<div class="line">       Log file path</div>
<div class="line">  -e{true},-n{false},--enforce-log-file{true}={true,false} [false]   </div>
<div class="line">       Enforce writing of logs to file for foreground applications</div>
<div class="line">  -d{true},-f{false},--daemonize{true}={true,false} [false]   </div>
<div class="line">       Start application as daemon</div>
<div class="line">  --user-name username [&lt;user&gt;]    Needs: --daemonize </div>
<div class="line">       Run daemon under specific user permissions</div>
<div class="line">  --group-name groupname [&lt;group&gt;]    Needs: --daemonize </div>
<div class="line">       Run daemon under specific group permissions</div>
</div><!-- fragment --><ul>
<li>Persistent options can be stored in a configuration file by appending <code>-w</code> or <code>--write-config</code> on the command line.</li>
<li>Non-persistent options are never stored in a configuration file.</li>
</ul>
<h4><a class="anchor" id="instance-configuration"></a>
Instance Configuration</h4>
<p>Each <em>named</em> <code>SocketServer</code> and <code>SocketClient</code> instance get their <em>specific set</em> of command line options accessible by specifying the instance name on the command line.</p>
<p>Thus, for instance if the <code>EchoServer</code> instance would have been created using and instance name as argument to the constructor like for example</p>
<div class="fragment"><div class="line">EchoServer echoServer(<span class="stringliteral">&quot;echo&quot;</span>); <span class="comment">// Create named server instance</span></div>
</div><!-- fragment --><p>(try it yourself using the code from github in the <b><a href="https://github.com/SNodeC/echo/tree/named-instance">named-instance</a></b> branch of the echo application), the output of the help screen changes slightly:</p>
<div class="fragment"><div class="line">Configuration for Application &#39;echoserver&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver [OPTIONS] [INSTANCES [--help]]</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -c,--config-file configfile:NOT DIR [/home/&lt;user&gt;/.config/snode.c/echoserver.conf] </div>
<div class="line">       Read a config file</div>
<div class="line">  -w,--write-config [configfile]:NOT DIR [/home/&lt;user&gt;/.config/snode.c/echoserver.conf] </div>
<div class="line">       Write config file and exit</div>
<div class="line">  -k,--kill</div>
<div class="line">       Kill running daemon</div>
<div class="line">  -i,--instance-alias instance=instance_alias [instance=instance_alias [...]] </div>
<div class="line">       Make an instance also known as an alias in configuration files</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all non-default and required options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  --version</div>
<div class="line">       Framework version</div>
<div class="line">  -h{standard},--help{standard}={standard,expanded} </div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  -l,--log-level level:INT in [0 - 6] [4]   </div>
<div class="line">       Log level</div>
<div class="line">  -v,--verbose-level level:INT in [0 - 10] [1]   </div>
<div class="line">       Verbose level</div>
<div class="line">  -q{true},-u{false},--quiet{true}={true,false} [false]   </div>
<div class="line">       Quiet mode</div>
<div class="line">  --log-file logfile:NOT DIR [/home/voc/.local/log/snode.c/echoserver.log]   </div>
<div class="line">       Log file path</div>
<div class="line">  -e{true},-n{false},--enforce-log-file{true}={true,false} [false]   </div>
<div class="line">       Enforce writing of logs to file for foreground applications</div>
<div class="line">  -d{true},-f{false},--daemonize{true}={true,false} [false]   </div>
<div class="line">       Start application as daemon</div>
<div class="line">  --user-name username [&lt;user&gt;]    Needs: --daemonize </div>
<div class="line">       Run daemon under specific user permissions</div>
<div class="line">  --group-name groupname [&lt;group&gt;]    Needs: --daemonize </div>
<div class="line">       Run daemon under specific group permissions</div>
<div class="line"> </div>
<div class="line">Instances:</div>
<div class="line">  echo Configuration for server instance &#39;echo&#39;</div>
</div><!-- fragment --><p><em><b>Note</b></em>: Now the named instance <em>echo</em> appears at the end of the help screen.</p>
<p>To get informations about what can be configured for the <em>echo</em> instance it is just needed to write</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo --help</div>
</div><!-- fragment --><p>what prints the output</p>
<div class="fragment"><div class="line">Configuration for server instance &#39;echo&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver echo [OPTIONS] [SECTIONS [--help]]</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all non-default and required options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  -h{standard},--help{standard}={standard,expanded} </div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  --disabled{true}={true,false} [false]   </div>
<div class="line">       Disable this instance</div>
<div class="line"> </div>
<div class="line">Sections:</div>
<div class="line">  local</div>
<div class="line">       Local side of connection for instance &#39;echo&#39;</div>
<div class="line">  remote</div>
<div class="line">       Remote side of connection for instance &#39;echo&#39;</div>
<div class="line">  connection</div>
<div class="line">       Configuration of established connections for instance &#39;echo&#39;</div>
<div class="line">  socket</div>
<div class="line">       Configuration of socket behavior for instance &#39;echo&#39;</div>
<div class="line">  server</div>
<div class="line">       Configuration of server socket for instance &#39;echo&#39;</div>
</div><!-- fragment --><p>on screen.</p>
<h5><a class="anchor" id="sections"></a>
Sections</h5>
<p>As one can see, there exists some sections for the instance <em>echo</em> each offering specific configuration items for specific instance behavior categories.</p>
<p>Most important for a <code>SocketServer</code> instance is the section <em>local</em>,</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo local --help</div>
<div class="line">Local side of connection for instance &#39;echo&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver echo local [OPTIONS]</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all non-default and required options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  -h,--help</div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  --host hostname|IPv4:TEXT [0.0.0.0]   </div>
<div class="line">       Host name or IPv4 address</div>
<div class="line">  --port port:UINT in [0 - 65535] [8001]   </div>
<div class="line">       Port number</div>
<div class="line">  --numeric={true,false} [false]   </div>
<div class="line">       Suppress host name lookup</div>
<div class="line">  --numeric-reverse={true,false} [false]   </div>
<div class="line">       Suppress reverse host name lookup</div>
</div><!-- fragment --><p>which offer configuration options to configure the host name or IP-Address and the port number the physical server socket should be bound to. Note, that the <em>default value</em> of the port number is <code>8001</code>, what is this port number used to activate the <em>echo</em> instance.</p>
<div class="fragment"><div class="line">echoServer.listen(8001, [](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>)&gt;&amp; onStatus) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    ...</div>
<div class="line">});</div>
</div><!-- fragment --><p>This port number can now be <em>overridden</em> on the command line so, that the <em>echo</em> listens on a different port number, e.g. <code>8080</code>.</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo local --port 8080</div>
<div class="line">2024-03-22 16:35:53 0000000000001 echo: listening on &#39;0.0.0.0:8080 (0.0.0.0)&#39;</div>
</div><!-- fragment --><p>To make this overridden port number <em>persistent</em> a configuration file can be generated and stored automatically by appending <code>-w</code></p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo local --port 8080 -w</div>
<div class="line">Writing config file: /home/&lt;user&gt;/.config/snode.c/echoserver.conf</div>
</div><!-- fragment --><p>to the command line above. If <em>echoserver</em> is now started without command line arguments</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver</div>
<div class="line">2024-03-22 16:36:53 0000000000001 echo: listening on 0.0.0.0:8080</div>
</div><!-- fragment --><p>the in the configuration file stored port number <code>8080</code> is used instead of the port number <code>8001</code> used directly in the code.</p>
<p>All existing configuration options specified directly in the application code can be overridden on the command line and/or the configuration file in that way.</p>
<h5><a class="anchor" id="using-the-parameterless-listen-methods-when-no-configuration-file-exists"></a>
Using the Parameterless <code>listen()</code> Methods when no Configuration File exists</h5>
<p>In case the parameterless <code>listen()</code> method is used for activating a <em>named</em> server instance for example like</p>
<div class="fragment"><div class="line">EchoServer echoServer(<span class="stringliteral">&quot;echo&quot;</span>); <span class="comment">// Create server instance</span></div>
<div class="line">echoServer.listen([](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>)&gt;&amp; onStatus) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    ...</div>
<div class="line">});</div>
</div><!-- fragment --><p>and no configuration file exists, SNode.C notifies that at least a port number needs to be configured on the command line:</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver</div>
<div class="line">[RequiresError] echoserver requires echo</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoserver echo</div>
<div class="line">[RequiresError] echo requires local</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoserver echo local</div>
<div class="line">[RequiresError] local requires --port</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoserver echo local --port</div>
<div class="line">[ArgumentMismatch] --port: 1 required port:UINT in [0 - 65535] missing</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoserver echo local --port 8080</div>
<div class="line">2024-03-22 16:42:44 0000000000001 echo: listening on &#39;0.0.0.0:8080 (0.0.0.0)&#39;</div>
</div><!-- fragment --><p>Again, this configuration can be made permanent by writing the configuration file by appending <code>-w</code> to the command line:</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo local --port 8080 -w</div>
<div class="line">Writing config file: /home/&lt;user&gt;/.config/snode.c/echoserver.conf</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoserver</div>
<div class="line">2024-03-22 16:43:30 0000000000001 echo: listening on &#39;0.0.0.0:8080 (0.0.0.0)&#39;</div>
</div><!-- fragment --><h5><a class="anchor" id="using-the-parameterless-connect-methods-when-no-configuration-file-exists"></a>
Using the Parameterless <code>connect()</code> Methods when no Configuration File exists</h5>
<p>A <em>named</em> client instance is configured in the very same way.</p>
<p>Lets have look at the case of the named <em>echoclient</em></p>
<div class="fragment"><div class="line">EchoClient echoClient(<span class="stringliteral">&quot;echo&quot;</span>); <span class="comment">// Create named client instance</span></div>
<div class="line">echoClient.connect([](<span class="keyword">const</span> SocketAddress&amp; socketAddress, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> SocketAddress&amp;, <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>)&gt;&amp; onStatus) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    ...</div>
<div class="line">});</div>
</div><!-- fragment --><p>where the parameterless <code>connect()</code> method is used. A terminal session would look like:</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoclient</div>
<div class="line">[RequiresError] echoclient echo is required</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo</div>
<div class="line">[RequiresError] echo requires remote</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo remote</div>
<div class="line">[RequiresError] remote requires --port</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo remote --port</div>
<div class="line">[ArgumentMismatch] --port: 1 required port:UINT in [0 - 65535] missing</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo remote --port 8080</div>
<div class="line">[RequiresError] remote requires --host</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo remote --port 8080 --host</div>
<div class="line">[ArgumentMismatch] --host: 1 required hostname|IPv4:TEXT missing</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient echo remote --port 8080 --host localhost</div>
<div class="line">2024-03-22 16:48:39 0000000000002 echo: connected to &#39;localhost:8080 (localhost)&#39;</div>
<div class="line">2024-03-22 16:48:39 0000000000002 INFO OnConnect echoclient</div>
<div class="line">2024-03-22 16:48:39 0000000000002 INFO  Local: localhost:44045 (localhost)</div>
<div class="line">2024-03-22 16:48:39 0000000000002 INFO  Peer: localhost:8080 (localhost)</div>
<div class="line">2024-03-22 16:48:39 0000000000002 INFO OnConnected echoclient</div>
<div class="line">2024-03-22 16:48:39 0000000000002 Echo connected</div>
<div class="line">Initiating data exchange</div>
<div class="line">Success: Echo connected to localhost:8080</div>
<div class="line">Data to reflect: Hello peer! It&#39;s nice talking to you!!!</div>
<div class="line">Data to reflect: Hello peer! It&#39;s nice talking to you!!!</div>
<div class="line">...</div>
</div><!-- fragment --><p>Again this configuration can be made permanent by writing the configuration file using <code>-w</code> on the command line:</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoclient echo remote --port 8080 --host localhost -w</div>
<div class="line">Writing config file: /home/&lt;user&gt;/.config/snode.c/echoclient.conf</div>
<div class="line"> </div>
<div class="line">command@line:~/&gt; echoclient</div>
<div class="line">2024-03-22 16:50:09 0000000000002 echo: connected to &#39;localhost:8080 (localhost)&#39;</div>
<div class="line">2024-03-22 16:50:09 0000000000002 INFO OnConnect echoclient</div>
<div class="line">2024-03-22 16:50:09 0000000000002 INFO  Local: localhost:53163 (localhost)</div>
<div class="line">2024-03-22 16:50:09 0000000000002 INFO  Peer: localhost:8080 (localhost)</div>
<div class="line">2024-03-22 16:50:09 0000000000002 INFO OnConnected echoclient</div>
<div class="line">2024-03-22 16:50:09 0000000000002 Echo connected</div>
<div class="line">Initiating data exchange</div>
<div class="line">Success: Echo connected to localhost:8080</div>
<div class="line">Data to reflect: Hello peer! It&#39;s nice talking to you!!!</div>
<div class="line">Data to reflect: Hello peer! It&#39;s nice talking to you!!!</div>
<div class="line">...</div>
</div><!-- fragment --><h4><a class="anchor" id="anatomy-of-the-command-line-interface"></a>
Anatomy of the Command Line Interface</h4>
<p>The command line interface follows a well defined structure, for example</p>
<div class="fragment"><div class="line">command@line:~/&gt; serverorclientexecutable --app-opt1 val1 --app-opt2 val2 instance1 --inst-opt1 val11 --int-opt2 val12 section11 --sec1-opt1 val111 --sec1-opt2 val112 section12 --sec2-opt1 val121 --sec2-opt2 val122 instance2 --inst-opt1 val21 --inst-opt2 val22 section21 --sec1-opt1 val211 --sec1-opt2 val212 section22 --sec2-opt1 val221 --sec2-opt2 val222</div>
</div><!-- fragment --><p>if two instances with instance names <em>instance1</em> and <em>instance2</em> are present in the executable.</p>
<p>All section names following an instance name are treaded as sections modifying that instance. In case a further instance name is given, than all sections following that second instance name are treaded as sections modifying that second instance.</p>
<p>One can switch between sections by just specifying a different section name.</p>
<h3><a class="anchor" id="configuration-via-a-configuration-file"></a>
Configuration via a Configuration File</h3>
<p>For every application a configuration file can be generated by appending the switch <code>-w</code> or <code>--write-config</code> to the command line. Optionally <code>--write-config</code> takes a filename as value. If no filename is provided a default filename is used (see <a class="el" href="#default-name-of-a-configuration-file">Default Name of a Configuration File</a>).</p>
<h4><a class="anchor" id="configuration-file-format"></a>
Configuration File Format</h4>
<p>Each configuration option which is marked as <em>persistent</em> in the help output can also be configured via a configuration file. The names of the entries for options in such a configuration file follow a well defined structure.</p>
<div class="fragment"><div class="line">instancename.sectionname.optionname = value</div>
</div><!-- fragment --><p>Thus to configure the port number the <em>echoserver</em> with server instance name <em>echo</em> shall listen on the entry in the configuration file would look like</p>
<div class="fragment"><div class="line">echo.local.port = 8080</div>
</div><!-- fragment --><p>and for the <em>echoclient</em> the remote hostname or ip-address and the remote port number is configured by specifying</p>
<div class="fragment"><div class="line">echo.remote.host = &quot;localhost&quot;</div>
<div class="line">echo.remote.port = 8080</div>
</div><!-- fragment --><p>The content of a configuration file can be printed on screen by appending the flag <code>-s</code> on the command line.</p>
<p>Thus, the configuration of the <em>echoserver</em> configured and made persistent on the command can be shown using</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver -s</div>
</div><!-- fragment --><p>which leads to the output</p>
<div class="fragment"><div class="line">### Configuration for Application &#39;echoserver&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Log level</div>
<div class="line">#log-level=4</div>
<div class="line"> </div>
<div class="line"># Verbose level</div>
<div class="line">#verbose-level=1</div>
<div class="line"> </div>
<div class="line"># Quiet mode</div>
<div class="line">#quiet=false</div>
<div class="line"> </div>
<div class="line"># Log file path</div>
<div class="line">#log-file=&quot;/home/&lt;user&gt;/.local/log/snode.c/echoserver.log&quot;</div>
<div class="line"> </div>
<div class="line"># Enforce writing of logs to file for foreground applications</div>
<div class="line">#enforce-log-file=false</div>
<div class="line"> </div>
<div class="line"># Start application as daemon</div>
<div class="line">#daemonize=false</div>
<div class="line"> </div>
<div class="line"># Run daemon under specific user permissions</div>
<div class="line">#user-name=&quot;&lt;user&gt;&quot;</div>
<div class="line"> </div>
<div class="line"># Run daemon under specific group permissions</div>
<div class="line">#group-name=&quot;&lt;group&gt;&quot;</div>
<div class="line"> </div>
<div class="line">### Configuration for server instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Disable this instance</div>
<div class="line">#echo.disabled=false</div>
<div class="line"> </div>
<div class="line">### Local side of connection for instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Host name or IPv4 address</div>
<div class="line">#echo.local.host=&quot;0.0.0.0&quot;</div>
<div class="line"> </div>
<div class="line"># Port number</div>
<div class="line">#echo.local.port=8001</div>
<div class="line"> </div>
<div class="line"># Suppress host name lookup</div>
<div class="line">#echo.local.numeric=false</div>
<div class="line"> </div>
<div class="line"># Suppress reverse host name lookup</div>
<div class="line">#echo.local.numeric-reverse=false</div>
<div class="line"> </div>
<div class="line">### Remote side of connection for instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Suppress reverse host name lookup</div>
<div class="line">#echo.remote.numeric-reverse=false</div>
<div class="line"> </div>
<div class="line">### Configuration of established connections for instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Read timeout in seconds</div>
<div class="line">#echo.connection.read-timeout=60</div>
<div class="line"> </div>
<div class="line"># Write timeout in seconds</div>
<div class="line">#echo.connection.write-timeout=60</div>
<div class="line"> </div>
<div class="line"># Read block size</div>
<div class="line">#echo.connection.read-block-size=16384</div>
<div class="line"> </div>
<div class="line"># Write block size</div>
<div class="line">#echo.connection.write-block-size=16384</div>
<div class="line"> </div>
<div class="line"># Terminate timeout</div>
<div class="line">#echo.connection.terminate-timeout=1</div>
<div class="line"> </div>
<div class="line">### Configuration of socket behavior for instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Reuse socket address</div>
<div class="line">#echo.socket.reuse-address=false</div>
<div class="line"> </div>
<div class="line"># Automatically retry listen|connect</div>
<div class="line">#echo.socket.retry=false</div>
<div class="line"> </div>
<div class="line"># Retry also on fatal errors</div>
<div class="line">#echo.socket.retry-on-fatal=false</div>
<div class="line"> </div>
<div class="line"># Timeout of the retry timer</div>
<div class="line">#echo.socket.retry-timeout=1</div>
<div class="line"> </div>
<div class="line"># Number of retry attempts before giving up (0 = unlimited)</div>
<div class="line">#echo.socket.retry-tries=0</div>
<div class="line"> </div>
<div class="line"># Base of exponential backoff</div>
<div class="line">#echo.socket.retry-base=1.8</div>
<div class="line"> </div>
<div class="line"># Maximum jitter in percent to apply randomly to calculated retry timeout (0 to disable)</div>
<div class="line">#echo.socket.retry-jitter=0</div>
<div class="line"> </div>
<div class="line"># Upper limit in seconds of retry timeout</div>
<div class="line">#echo.socket.retry-limit=0</div>
<div class="line"> </div>
<div class="line"># Accept timeout</div>
<div class="line">#echo.socket.accept-timeout=0</div>
<div class="line"> </div>
<div class="line"># Reuse port number</div>
<div class="line">#echo.socket.reuse-port=false</div>
<div class="line"> </div>
<div class="line">### Configuration of server socket for instance &#39;echo&#39;</div>
<div class="line">## Options (persistent)</div>
<div class="line"># Listen backlog</div>
<div class="line">#echo.server.backlog=5</div>
<div class="line"> </div>
<div class="line"># Accepts per tick</div>
<div class="line">#echo.server.accepts-per-tick=1</div>
</div><!-- fragment --><p><em><b>Note</b></em>: Options with default values, which includes option values configured in-code, are commented in the configuration file.</p>
<h4><a class="anchor" id="default-name-of-a-configuration-file"></a>
Default Name of a Configuration File</h4>
<p>The default name of a configuration file is simple the application name to which <code>.conf</code> is appended.</p>
<p>Thus, for the <em>echoserver</em> and the <em>echoclient</em> the names of their configuration files are</p>
<ul>
<li><code>echoserver.conf</code></li>
<li><code>echoclient.conf</code></li>
</ul>
<h4><a class="anchor" id="default-location-of-configuration-files"></a>
Default Location of Configuration Files</h4>
<p>Configuration files are stored in directories following the <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base Directory Specification</a>. So these directories differ if an application is run as ordinary user or as the root user.</p>
<ul>
<li><b>Ordinary User</b>: <code>$HOME/.config/snode.c/</code></li>
<li><b>Root User</b>: <code>/etc/snode.c/</code></li>
</ul>
<p>This directories are created automatically by an application in case they did not exist.</p>
<h2><a class="anchor" id="important-configuration-sections"></a>
Important Configuration Sections</h2>
<h3><a class="anchor" id="ssltls-configuration-section-tls"></a>
SSL/TLS Configuration (Section <em>tls</em>)</h3>
<p>SSL/TLS encryption is provided if a SSL/TLS server or client instance is used.</p>
<p>Equivalent to all other configuration options SSL/TLS encryption can be configured either in-code, on the command line or via configuration files.</p>
<p>In most scenarios it is sufficient to specify a CA-certificate, a certificate chain, a certificate key and, in case the key is encrypted, a password.</p>
<p><em><b>Important</b></em>: CA-certificate, certificate chain, and certificate key needs to be in <em>PEM format</em>.</p>
<p>In case a CA-certificate is configured either on the server and/or the client side a certificate request is send to the peer during the initial SSL/TLS handshake. In case the peer answers with a valid certificate response this response can be validated in-code in the <code>onConnected</code> callback of a <code>SocketServer</code> or <code>SocketClient</code> class.</p>
<p><em><b>Warning</b></em>: Passwords either provided in-code or on the command line are not obfuscated in memory during runtime. Thus, it is a good idea to not specify a password in-code or on the command line. In that case OpenSSL asks for the password on the command line during application startup. This password is only used internally by OpenSSL and is removed from memory as soon as the keys have been decrypted.</p>
<p><em><b>Warning</b></em>: Hold all keys and their passwords secured!</p>
<h4><a class="anchor" id="ssltls-in-code-configuration"></a>
SSL/TLS In-Code Configuration</h4>
<p>If the <em>echo</em> server instance would have been created using a SSL/TLS-SocketServer class like e.g.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoServer = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::tls::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoServer::SocketAddress;</div>
<div class="line"> </div>
<div class="line">EchoServer echoServer(<span class="stringliteral">&quot;echo&quot;</span>);</div>
</div><!-- fragment --><p>than SSL/TLS could be configured in-code using</p>
<div class="fragment"><div class="line">echoServer.getConfig().setCaCert(<span class="stringliteral">&quot;&lt;path to X.509 CA certificate&gt;&quot;</span>);      <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoServer.getConfig().setCert(<span class="stringliteral">&quot;&lt;path to X.509 certificate chain&gt;&quot;</span>);     <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoServer.getConfig().setCertKey(<span class="stringliteral">&quot;&lt;path to X.509 certificate key&gt;&quot;</span>);    <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoServer.getConfig().setCertKeyPassword(<span class="stringliteral">&quot;&lt;certificate key password&gt;&quot;</span>);</div>
</div><!-- fragment --><p>The same technique can be used for the client instance</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>EchoClient = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketClient.html">net::in::stream::tls::SocketClient&lt;EchoClientContextFactory&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>SocketAddress = EchoClient::SocketAddress;</div>
<div class="line"> </div>
<div class="line">EchoClient echoClient(<span class="stringliteral">&quot;echo&quot;</span>);</div>
<div class="line"> </div>
<div class="line">echoClient.getConfig().setCaCert(<span class="stringliteral">&quot;&lt;path to X.509 CA certificate&gt;&quot;</span>);      <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoClient.getConfig().setCert(<span class="stringliteral">&quot;&lt;path to X.509 certificate chain&gt;&quot;</span>);     <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoClient.getConfig().setCertKey(<span class="stringliteral">&quot;&lt;path to X.509 certificate key&gt;&quot;</span>);    <span class="comment">// Has to be in PEM format</span></div>
<div class="line">echoClient.getConfig().setCertKeyPassword(<span class="stringliteral">&quot;&lt;certificate key password&gt;&quot;</span>);</div>
</div><!-- fragment --><h4><a class="anchor" id="ssltls-command-line-configuration"></a>
SSL/TLS Command Line Configuration</h4>
<p><em><b>Note</b></em>: The in-code configuration can be overridden on the command line like all other configuration items.</p>
<p>Using this SSL/TLS <em>echo</em> instance the help screen offers an additional section <em>tls</em> which provides the command line arguments to configure SSL/TLS behaviour.</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo --help</div>
<div class="line">Configuration for server instance &#39;echo&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver echo [OPTIONS] [SECTIONS [--help]]  REQUIRED</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all non-default and required options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  -h{standard},--help{standard}={standard,expanded} </div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  --disabled{true}={true,false} [false]   </div>
<div class="line">       Disable this instance</div>
<div class="line"> </div>
<div class="line">Sections:</div>
<div class="line">  local</div>
<div class="line">       Local side of connection for instance &#39;echo&#39;</div>
<div class="line">  connection</div>
<div class="line">       Configuration of established connections for instance &#39;echo&#39;</div>
<div class="line">  socket</div>
<div class="line">       Configuration of socket behaviour for instance &#39;echo&#39;</div>
<div class="line">  server</div>
<div class="line">       Configuration of server socket for instance &#39;echo&#39;</div>
<div class="line">  tls  Configuration of SSL/TLS behaviour for instance &#39;echo&#39;</div>
</div><!-- fragment --><div class="fragment"><div class="line">command@line:~/&gt; echoserver echo tls --help</div>
<div class="line">Configuration of SSL/TLS behaviour for instance &#39;echo&#39;</div>
<div class="line"> </div>
<div class="line">Usage: echoserver echo tls [OPTIONS]</div>
<div class="line"> </div>
<div class="line">Options (nonpersistent):</div>
<div class="line">  -s,--show-config</div>
<div class="line">       Show current configuration and exit</div>
<div class="line">  --command-line{standard}={standard,required,full,default} </div>
<div class="line">       Print a command line</div>
<div class="line">         standard (default): View all non-default and required options</div>
<div class="line">         required: View required options only</div>
<div class="line">         full: View the full set of options with their default or configured values</div>
<div class="line">         default: View the full set of options with their default values</div>
<div class="line">  -h,--help</div>
<div class="line">       Print help message</div>
<div class="line"> </div>
<div class="line">Options (persistent):</div>
<div class="line">  --cert filename:PEM-FILE   </div>
<div class="line">       Certificate chain file</div>
<div class="line">  --cert-key filename:PEM-FILE   </div>
<div class="line">       Certificate key file</div>
<div class="line">  --cert-key-password password:TEXT   </div>
<div class="line">       Password for the certificate key file</div>
<div class="line">  --ca-cert filename:PEM-FILE   </div>
<div class="line">       CA-certificate file</div>
<div class="line">  --ca-cert-dir directory:PEM-CONTAINER-DIR   </div>
<div class="line">       CA-certificate directory</div>
<div class="line">  --ca-cert-use-default-dir{true}={true,false} [false]   </div>
<div class="line">       Use default CA-certificate directory</div>
<div class="line">  --cipher-list cipher_list:CIPHER   </div>
<div class="line">       Cipher list (OpenSSL syntax)</div>
<div class="line">  --tls-options options:UINT [0]   </div>
<div class="line">       OR combined SSL/TLS options (OpenSSL values)</div>
<div class="line">  --init-timeout timeout:POSITIVE [10]   </div>
<div class="line">       SSL/TLS initialization timeout in seconds</div>
<div class="line">  --shutdown-timeout timeout:POSITIVE [1]   </div>
<div class="line">       SSL/TLS shutdown timeout in seconds</div>
<div class="line">  --sni-cert sni &lt;key&gt; value [&lt;key&gt; value] ... [%% sni &lt;key&gt; value [&lt;key&gt; value] ...] [&quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;] ... </div>
<div class="line">       Server Name Indication (SNI) Certificates:</div>
<div class="line">       sni = SNI of the virtual server</div>
<div class="line">       &lt;key&gt; = {</div>
<div class="line">                 &quot;CertChain&quot; -&gt; value:PEM-FILE,</div>
<div class="line">                 &quot;CertKey&quot; -&gt; value:PEM-FILE,</div>
<div class="line">                 &quot;CertKeyPassword&quot; -&gt; value:TEXT,</div>
<div class="line">                 &quot;CaCertFile&quot; -&gt; value:PEM-FILE,</div>
<div class="line">                 &quot;CaCertDir&quot; -&gt; value:PEM-CONTAINER:DIR,</div>
<div class="line">                 &quot;UseDefaultCaDir&quot; -&gt; value:BOOLEAN [false],</div>
<div class="line">                 &quot;SslOptions&quot; -&gt; value:UINT</div>
<div class="line">               }</div>
<div class="line">  --force-sni{true}={true,false} [false]   </div>
<div class="line">       Force using of the Server Name Indication</div>
</div><!-- fragment --><p>All available SSL/TLS options are listed in this help screen.</p>
<p>Thus the certificates can also be configured on the command line e.g.</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo tls --ca-cert &lt;path to X.509 CA certificate&gt; --cert &lt;path to X.509 certificate chain&gt; --cert-key &lt;path to X.509 certificate key&gt; --cert-key-password &lt;certificate key password&gt;</div>
</div><!-- fragment --><p>The demo code for this application can be found on github in the branch <a href="https://github.com/SNodeC/echo/tree/named-instance-tls">named-instance-tls</a>. Included in that branch is the directory <em>certs</em> where demo self signed CA certificate authorities with corresponding certificates for server and client can be found. This certificates have been created using the tool <a href="https://hohnstaedt.de/xca/">XCA</a>. The database of XCA for this certificates can also be found in that directory. The password of the XCA database and the keys is always 'snode.c'.</p>
<p><em><b>Warning</b></em>: Do not use this certificates for production! But the database of XCA can be used as template for own certificate creation.</p>
<p>This certificates can be applied to the echo server and client applications either in-code or on the command line like for instance</p>
<div class="fragment"><div class="line">command@line:~/&gt; echoserver echo tls --ca-cert [absolute-path-to]/SNode.C-Client-CA.crt --cert [absolute-path-to]/Snode.C-Server-Cert.pem --cert-key [absolute-path-to]/Snode.C-Server-Cert.key --cert-key-password snode.c</div>
</div><!-- fragment --><div class="fragment"><div class="line">command@line:~/&gt; echoclient echo tls --ca-cert [absolute-path-to]/SNode.C-Server-CA.crt --cert [absolute-path-to]/Snode.C-Client-Cert.pem --cert-key [absolute-path-to]/Snode.C-Client-Cert.key --cert-key-password snode.c</div>
</div><!-- fragment --><h4><a class="anchor" id="using-ssltls-with-other-network-layers"></a>
Using SSL/TLS with Other Network Layers</h4>
<p>All supported network layers (IPv4, IPv6, Unix-Domain Sockets, RFCOMM, and L2CAP) combined with a connection oriented transport layer (SOCK_STREAM) can be secured with exactly the same technique. This is funny because e.g. bluetooth already provides encryption but can be made even more secure using SSL/TLS. But yes, we get this feature automatically due to the internal architecture of the framework.</p>
<h3><a class="anchor" id="socket-configuration-section-socket"></a>
Socket Configuration (Section <em>socket</em>)</h3>
<p>Via this section socket options can be configured.</p>
<h4><a class="anchor" id="common-socket-options-for-socketserver-and-socketclient-instances"></a>
Common <em>socket</em> Options for <em>SocketServer</em> and <em>SocketClient</em> Instances</h4>
<p>Some configuration options are common for all SocketServer and SocketClient instances</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Line Configuration   </th><th class="markdownTableHeadNone">In-Code Configuration   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--reuse-address=[true, false]</code>   </td><td class="markdownTableBodyNone"><code>instance.getConfig().setReuseAddress(bool reuse = true)</code>   </td><td class="markdownTableBodyNone">This flag turns on address reuse. Thus if a socket is left in a TIME_WAIT state after application shutdown the address and port/channel/psm number tuple can be reused immediately.<br  />
<em><b>Recommendation</b></em>: Leave on <code>false</code> for production but set to <code>true</code> during development.   </td></tr>
</table>
<h4><a class="anchor" id="specific-socket-options-for-ipv4-and-ipv6-socketserver"></a>
Specific <em>socket</em> Options for IPv4 and IPv6 <em>SocketServer</em></h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Line Configuration   </th><th class="markdownTableHeadNone">In-Code Configuration   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--reuse-port=[true, false]</code>   </td><td class="markdownTableBodyNone"><code>instance.getConfig().setReusePort(bool reuse = true)</code>   </td><td class="markdownTableBodyNone">This flag turns on port reuse so multiple server applications can listening on the same address and port number tuple simultaneously.<br  />
With this option set to <code>true</code> one can start a server application multiple times and the operating system (Linux) routes incoming client connection requests randomly to one of the running application instances. So one can achieve a simple load balancing/multitasking application.   </td></tr>
</table>
<h4><a class="anchor" id="specific-socket-options-for-ipv6-socketserver-and-socketclient"></a>
Specific <em>socket</em> Options for IPv6 <em>SocketServer</em> and <em>SocketClient</em></h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Line Configuration   </th><th class="markdownTableHeadNone">In-Code Configuration   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>--ipv6-only=[true, false]</code>   </td><td class="markdownTableBodyNone"><code>instance.getConfig().setIPv6Only(bool only = true)</code>   </td><td class="markdownTableBodyNone">By default if a IPv6 socket is created on Linux it is a dual-stack socket also using IPv4 addresses. In case this flag is set to <code>true</code> a pure IPv6 socket is created.   </td></tr>
</table>
<h1><a class="anchor" id="using-more-than-one-instance-in-an-application"></a>
Using More Than One Instance in an Application</h1>
<p>SNode.C is designed to run multiple Server and Client Instances in one Application.</p>
<p>For instance, if the echo server shall also communicate via e.g. Unix-Domain sockets and Bluetoot-RFCOMM those two server Instances need to be added but the application level protocol need not to be changed. The code can be found on github in the <b><a href="https://github.com/VolkerChristian/echo/tree/multiple-instances">multiple-instances</a></b> branch of the echo application.</p>
<p>In that case the Main-Application would look like</p>
<div class="fragment"><div class="line"> <span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a>(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>EchoServerIn = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketServer.html">net::in::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressIn = EchoServerIn::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    EchoServerIn echoServerIn;</div>
<div class="line">    echoServerIn.<a class="code hl_function" href="classnet_1_1in_1_1stream_1_1SocketServer.html#ab7e15343deb4840ebbdf478db3263c92">listen</a>(8001, </div>
<div class="line">                        [](<span class="keyword">const</span> SocketAddressIn&amp; socketAddress,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerIn: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerIn: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoServerIn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoServerIn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>EchoServerUn = <a class="code hl_class" href="classnet_1_1un_1_1stream_1_1SocketServer.html">net::un::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressUn = EchoServerUn::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    EchoServerUn echoServerUn;</div>
<div class="line">    echoServerUn.<a class="code hl_function" href="classnet_1_1un_1_1stream_1_1SocketServer.html#a69bea4f3dcf298db01a0c70309445610">listen</a>(<span class="stringliteral">&quot;/tmp/echoserver&quot;</span>,</div>
<div class="line">                        [](<span class="keyword">const</span> SocketAddressUn&amp; socketAddress, </div>
<div class="line">                           <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerUn: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerUn: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoServerUn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoServerUn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>EchoServerRc = <a class="code hl_class" href="classnet_1_1rc_1_1stream_1_1SocketServer.html">net::rc::stream::legacy::SocketServer&lt;EchoServerContextFactory&gt;</a>;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressRc = EchoServerRc::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Disabled because a peer would be needed and that&#39;s out of scope of this demo app.</span></div>
<div class="line">    <span class="comment">// If a peer exists and runs the echo server remove the commented line</span></div>
<div class="line">    <span class="comment">// echoClientRc.getConfig().setDisabled() and specify the bluetooth address and channel</span></div>
<div class="line">    <span class="comment">// of the peer.</span></div>
<div class="line">    EchoServerRc echoServerRc;</div>
<div class="line">    echoServerRc.<a class="code hl_function" href="classcore_1_1socket_1_1Socket.html#ac9b7df3682b2a24b5c7fce9bcff1c441">getConfig</a>().setDisabled();</div>
<div class="line">    echoServerRc.listen(16, </div>
<div class="line">                        [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress, </div>
<div class="line">                           <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerRc: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoServerRc: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoServerRc: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoServerRc: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a>(); <span class="comment">// Start the event loop, daemonize if requested.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclasscore_1_1socket_1_1Socket_html_ac9b7df3682b2a24b5c7fce9bcff1c441"><div class="ttname"><a href="classcore_1_1socket_1_1Socket.html#ac9b7df3682b2a24b5c7fce9bcff1c441">core::socket::Socket::getConfig</a></div><div class="ttdeci">Config &amp; getConfig() const</div><div class="ttdef"><b>Definition</b> <a href="Socket_8hpp_source.html#l00060">Socket.hpp:60</a></div></div>
<div class="ttc" id="aclassnet_1_1in_1_1stream_1_1SocketServer_html_ab7e15343deb4840ebbdf478db3263c92"><div class="ttname"><a href="classnet_1_1in_1_1stream_1_1SocketServer.html#ab7e15343deb4840ebbdf478db3263c92">net::in::stream::SocketServer::listen</a></div><div class="ttdeci">void listen(uint16_t port, const std::function&lt; void(const SocketAddress &amp;, core::socket::State)&gt; &amp;onStatus) const</div><div class="ttdef"><b>Definition</b> <a href="net_2in_2stream_2SocketServer_8h_source.html#l00075">SocketServer.h:75</a></div></div>
<div class="ttc" id="aclassnet_1_1rc_1_1stream_1_1SocketServer_html"><div class="ttname"><a href="classnet_1_1rc_1_1stream_1_1SocketServer.html">net::rc::stream::SocketServer</a></div><div class="ttdef"><b>Definition</b> <a href="net_2rc_2stream_2SocketServer_8h_source.html#l00062">SocketServer.h:65</a></div></div>
<div class="ttc" id="aclassnet_1_1un_1_1stream_1_1SocketServer_html"><div class="ttname"><a href="classnet_1_1un_1_1stream_1_1SocketServer.html">net::un::stream::SocketServer</a></div><div class="ttdef"><b>Definition</b> <a href="net_2un_2stream_2SocketServer_8h_source.html#l00062">SocketServer.h:65</a></div></div>
<div class="ttc" id="aclassnet_1_1un_1_1stream_1_1SocketServer_html_a69bea4f3dcf298db01a0c70309445610"><div class="ttname"><a href="classnet_1_1un_1_1stream_1_1SocketServer.html#a69bea4f3dcf298db01a0c70309445610">net::un::stream::SocketServer::listen</a></div><div class="ttdeci">void listen(const std::string &amp;sunPath, const std::function&lt; void(const SocketAddress &amp;, core::socket::State)&gt; &amp;onStatus) const</div><div class="ttdef"><b>Definition</b> <a href="net_2un_2stream_2SocketServer_8h_source.html#l00075">SocketServer.h:75</a></div></div>
</div><!-- fragment --><p>and the client application with an additional Unix-Domain socket instance look like</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="classcore_1_1SNodeC.html#a2c8b01c5fc6ecc3036cb48a76f76f3b5">core::SNodeC::init</a>(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> std::string ipv4(<span class="stringliteral">&quot;IPv4 Socket&quot;</span>);</div>
<div class="line">    <span class="keyword">using </span>EchoClientIn = <a class="code hl_class" href="classnet_1_1in_1_1stream_1_1SocketClient.html">net::in::stream::legacy::SocketClient&lt;EchoClientContextFactory&lt;ipv4&gt;</a>&gt;;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressIn = EchoClientIn::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    EchoClientIn echoClientIn;</div>
<div class="line">    echoClientIn.<a class="code hl_function" href="classnet_1_1in_1_1stream_1_1SocketClient.html#afb0a0ad82eb97fb4f6ae9eef32c8e977">connect</a>(<span class="stringliteral">&quot;localhost&quot;</span>,</div>
<div class="line">                         8001,</div>
<div class="line">                         [](<span class="keyword">const</span> SocketAddressIn&amp; socketAddress,</div>
<div class="line">                            <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientIn: connected to &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientIn: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoClientIn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoClientIn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> std::string unixDomain(<span class="stringliteral">&quot;Unix-Domain Socket&quot;</span>);</div>
<div class="line">    <span class="keyword">using </span>EchoClientUn = <a class="code hl_class" href="classnet_1_1un_1_1stream_1_1SocketClient.html">net::un::stream::legacy::SocketClient&lt;EchoClientContextFactory&lt;unixDomain&gt;</a>&gt;;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressUn = EchoClientUn::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    EchoClientUn echoClientUn;</div>
<div class="line">    echoClientUn.<a class="code hl_function" href="classnet_1_1un_1_1stream_1_1SocketClient.html#a7c407d5ff705c87791449610cf5e1895">connect</a>(<span class="stringliteral">&quot;/tmp/echoserver&quot;</span>, </div>
<div class="line">                         [](<span class="keyword">const</span> SocketAddressUn&amp; socketAddress, </div>
<div class="line">                            <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientUn: connected to &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientUn: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoClientUn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoClientUn: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Disabled because a peer would be needed and that&#39;s out of scope of this demo app.</span></div>
<div class="line">    <span class="comment">// If a peer exists and runs the echo server remove the commented line</span></div>
<div class="line">    <span class="comment">// echoClientRc.getConfig().setDisabled(); specify the bluetooth address and channel</span></div>
<div class="line">    <span class="comment">// of the peer.</span></div>
<div class="line">    <span class="keyword">static</span> std::string rc(<span class="stringliteral">&quot;RFCOMM Socket&quot;</span>);</div>
<div class="line">    <span class="keyword">using </span>EchoClientRc = <a class="code hl_class" href="classnet_1_1rc_1_1stream_1_1SocketClient.html">net::rc::stream::legacy::SocketClient&lt;EchoClientContextFactory&lt;rc&gt;</a>&gt;;</div>
<div class="line">    <span class="keyword">using </span>SocketAddressRc = EchoClientRc::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    EchoClientRc echoClientRc; <span class="comment">// Create client instance</span></div>
<div class="line">    echoClientRc.<a class="code hl_function" href="classcore_1_1socket_1_1Socket.html#ac9b7df3682b2a24b5c7fce9bcff1c441">getConfig</a>().setDisabled();</div>
<div class="line">    echoClientRc.connect(<span class="stringliteral">&quot;10:3D:1C:AC:BA:9C&quot;</span>,</div>
<div class="line">                         1,</div>
<div class="line">                         [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress,</div>
<div class="line">                            <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientRc: connected to &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;EchoClientRc: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;EchoClientRc: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                LOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;EchoClientRc: &quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; state.<a class="code hl_function" href="classcore_1_1socket_1_1State.html#a55b6abd55034b331fae4c9e085007dfa">what</a>();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classcore_1_1SNodeC.html#ac3d0dcb6c216ae72d9bbb77fe080e461">core::SNodeC::start</a>(); <span class="comment">// Start the event loop, daemonize if requested.</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassnet_1_1in_1_1stream_1_1SocketClient_html_afb0a0ad82eb97fb4f6ae9eef32c8e977"><div class="ttname"><a href="classnet_1_1in_1_1stream_1_1SocketClient.html#afb0a0ad82eb97fb4f6ae9eef32c8e977">net::in::stream::SocketClient::connect</a></div><div class="ttdeci">void connect(const std::string &amp;ipOrHostname, uint16_t port, const std::function&lt; void(const SocketAddress &amp;, core::socket::State)&gt; &amp;onStatus) const</div><div class="ttdef"><b>Definition</b> <a href="net_2in_2stream_2SocketClient_8h_source.html#l00075">SocketClient.h:75</a></div></div>
<div class="ttc" id="aclassnet_1_1rc_1_1stream_1_1SocketClient_html"><div class="ttname"><a href="classnet_1_1rc_1_1stream_1_1SocketClient.html">net::rc::stream::SocketClient</a></div><div class="ttdef"><b>Definition</b> <a href="net_2rc_2stream_2SocketClient_8h_source.html#l00062">SocketClient.h:65</a></div></div>
<div class="ttc" id="aclassnet_1_1un_1_1stream_1_1SocketClient_html"><div class="ttname"><a href="classnet_1_1un_1_1stream_1_1SocketClient.html">net::un::stream::SocketClient</a></div><div class="ttdef"><b>Definition</b> <a href="net_2un_2stream_2SocketClient_8h_source.html#l00061">SocketClient.h:64</a></div></div>
<div class="ttc" id="aclassnet_1_1un_1_1stream_1_1SocketClient_html_a7c407d5ff705c87791449610cf5e1895"><div class="ttname"><a href="classnet_1_1un_1_1stream_1_1SocketClient.html#a7c407d5ff705c87791449610cf5e1895">net::un::stream::SocketClient::connect</a></div><div class="ttdeci">void connect(const std::string &amp;sunPath, const std::function&lt; void(const SocketAddress &amp;, core::socket::State)&gt; &amp;onStatus) const</div><div class="ttdef"><b>Definition</b> <a href="net_2un_2stream_2SocketClient_8h_source.html#l00074">SocketClient.h:74</a></div></div>
</div><!-- fragment --><p>The <code>EchoClientContextFactory</code> and the <code>EchoClientContext</code> has also be changed slightly to expect now a <code>std::string</code> as non-type template argument which is appended in the ping-pong initiation to the string send to the server to distinguish both instances in the output of the application.</p>
<h1><a class="anchor" id="application-leyer-protocols-apis"></a>
Application Leyer Protocols APIs</h1>
<h2><a class="anchor" id="basic-http-server-and-http-client-api"></a>
Basic HTTP-Server and HTTP-Client API</h2>
<p>To be written</p>
<h2><a class="anchor" id="highlevel-web-api-ala-nodejs-express"></a>
Highlevel WEB-API a'la Node.JS-Express</h2>
<p>To be written</p>
<h2><a class="anchor" id="websockets"></a>
WebSockets</h2>
<p>To be written</p>
<h2><a class="anchor" id="basic-mqtt-server-and-mqtt-client-api"></a>
Basic MQTT-Server and MQTT-Client API</h2>
<p>To be written</p>
<h2><a class="anchor" id="mqtt-over-websocket"></a>
MQTT Over WebSocket</h2>
<p>To be written</p>
<h1><a class="anchor" id="database-support"></a>
Database Support</h1>
<h2><a class="anchor" id="mariadb"></a>
MariaDB</h2>
<p>To be written</p>
<h1><a class="anchor" id="example-applications"></a>
Example Applications</h1>
<h2><a class="anchor" id="https-web-server-for-static-html-pages"></a>
HTTP/S Web-Server for Static HTML-Pages</h2>
<p>This application uses the high-level web API <em>express</em> which is very similar to the API of node.js/express. The <code>StaticMiddleware</code> is used to deliver the static HTML-pages.</p>
<p>The use of X.509 certificates for encrypted communication is demonstrated also.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="legacy_2in_2WebApp_8h.html">express/legacy/in/WebApp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="tls_2in_2WebApp_8h.html">express/tls/in/WebApp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="StaticMiddleware_8h.html">express/middleware/StaticMiddleware.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Logger_8h.html">log/Logger.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Config_8h.html">utils/Config.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    utils::Config::add_string_option(<span class="stringliteral">&quot;--web-root&quot;</span>, <span class="stringliteral">&quot;Root directory of the web site&quot;</span>, <span class="stringliteral">&quot;[path]&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_function" href="classexpress_1_1WebApp.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a>(argc, argv);</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">using </span>LegacyWebApp = <a class="code hl_typedef" href="namespaceexpress_1_1legacy_1_1in.html#ae117911fb1d6811868691d20e494b046">express::legacy::in::WebApp</a>;</div>
<div class="line">    <span class="keyword">using </span>LegacySocketAddress = LegacyWebApp::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    LegacyWebApp legacyApp;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classnet_1_1config_1_1ConfigSection.html">net::config::ConfigSection</a> configLegacyApp = <a class="code hl_class" href="classnet_1_1config_1_1ConfigSection.html">net::config::ConfigSection</a>(&amp;legacyApp.getConfig(),</div>
<div class="line">                                                                            <span class="stringliteral">&quot;www&quot;</span>, <span class="stringliteral">&quot;Web behavior of httpserver&quot;</span>);</div>
<div class="line">    CLI::Option* legacyHtmlRoot = configLegacyApp.add_option(legacyHtmlRoot,</div>
<div class="line">                                                             <span class="stringliteral">&quot;--html-root&quot;</span>, <span class="stringliteral">&quot;HTML root directory&quot;</span>, <span class="stringliteral">&quot;path&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    configLegacyApp.<a class="code hl_function" href="classnet_1_1config_1_1ConfigSection.html#afe7a0030f5ef727586a4dc6d32410ce7">required</a>(legacyHtmlRoot);</div>
<div class="line"> </div>
<div class="line">    legacyApp.setOnConnected([legacyApp, legacyHtmlRoot](SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> { <span class="comment">// onConnect</span></div>
<div class="line">        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;OnConnected &quot;</span> &lt;&lt; legacyApp.getConfig().getInstanceName();</div>
<div class="line">        legacyApp.use(<a class="code hl_class" href="classexpress_1_1middleware_1_1StaticMiddleware.html">express::middleware::StaticMiddleware</a>(legacyHtmlRoot-&gt;as&lt;std::string&gt;()));</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.listen(8080, [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: non critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>TLSWebApp = <a class="code hl_typedef" href="namespaceexpress_1_1tls_1_1in.html#a7fcb8097ef9b37166901c5561ccabd8f">express::tls::in::WebApp</a>;</div>
<div class="line">    <span class="keyword">using </span>TLSSocketAddress = TLSWebApp::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    TLSWebApp tlsApp;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classnet_1_1config_1_1ConfigSection.html">net::config::ConfigSection</a> configTlsApp = <a class="code hl_class" href="classnet_1_1config_1_1ConfigSection.html">net::config::ConfigSection</a>(&amp;tlsApp.getConfig(),</div>
<div class="line">                                                                         <span class="stringliteral">&quot;www&quot;</span>, <span class="stringliteral">&quot;Web behavior of httpserver&quot;</span>);</div>
<div class="line">    CLI::Option* tlsHtmlRoot = configTlsApp.add_option(tlsHtmlRoot,</div>
<div class="line">                                                       <span class="stringliteral">&quot;--html-root&quot;</span>, <span class="stringliteral">&quot;HTML root directory&quot;</span>, <span class="stringliteral">&quot;path&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    configTlsApp.<a class="code hl_function" href="classnet_1_1config_1_1ConfigSection.html#afe7a0030f5ef727586a4dc6d32410ce7">required</a>(tlsHtmlRoot);</div>
<div class="line"> </div>
<div class="line">    tlsApp.setOnConnected([tlsApp, tlsHtmlRoot](SocketConnection* socketConnection) -&gt; <span class="keywordtype">void</span> { <span class="comment">// onConnect</span></div>
<div class="line">        LOG(INFO) &lt;&lt; <span class="stringliteral">&quot;OnConnected &quot;</span> &lt;&lt; tlsApp.getConfig().getInstanceName();</div>
<div class="line">        tlsApp.use(<a class="code hl_class" href="classexpress_1_1middleware_1_1StaticMiddleware.html">express::middleware::StaticMiddleware</a>(tlsHtmlRoot-&gt;as&lt;std::string&gt;()));</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    tlsApp.getConfig().setCert(<span class="stringliteral">&quot;&lt;path to X.509 certificate chain&gt;&quot;</span>);</div>
<div class="line">    tlsApp.getConfig().setCertKey(<span class="stringliteral">&quot;&lt;path to X.509 certificate key&gt;&quot;</span>);</div>
<div class="line">    tlsApp.getConfig().setCertKeyPassword(<span class="stringliteral">&quot;&lt;certificate key password&gt;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    tlsApp.listen(8088, [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: non critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classexpress_1_1WebApp.html#a54e6910c9466c61d0b217490b7d9bb5a">express::WebApp::start</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aConfig_8h_html"><div class="ttname"><a href="Config_8h.html">Config.h</a></div></div>
<div class="ttc" id="aStaticMiddleware_8h_html"><div class="ttname"><a href="StaticMiddleware_8h.html">StaticMiddleware.h</a></div></div>
<div class="ttc" id="aclassexpress_1_1WebApp_html_a0a01439a0cc8dfc86ed14f1094826b7e"><div class="ttname"><a href="classexpress_1_1WebApp.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a></div><div class="ttdeci">static void init(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="WebApp_8cpp_source.html#l00056">WebApp.cpp:56</a></div></div>
<div class="ttc" id="aclassexpress_1_1WebApp_html_a54e6910c9466c61d0b217490b7d9bb5a"><div class="ttname"><a href="classexpress_1_1WebApp.html#a54e6910c9466c61d0b217490b7d9bb5a">express::WebApp::start</a></div><div class="ttdeci">static int start(const utils::Timeval &amp;timeOut={LONG_MAX, 0})</div><div class="ttdef"><b>Definition</b> <a href="WebApp_8cpp_source.html#l00060">WebApp.cpp:60</a></div></div>
<div class="ttc" id="aclassexpress_1_1middleware_1_1StaticMiddleware_html"><div class="ttname"><a href="classexpress_1_1middleware_1_1StaticMiddleware.html">express::middleware::StaticMiddleware</a></div><div class="ttdef"><b>Definition</b> <a href="StaticMiddleware_8h_source.html#l00059">StaticMiddleware.h:59</a></div></div>
<div class="ttc" id="aclassnet_1_1config_1_1ConfigSection_html"><div class="ttname"><a href="classnet_1_1config_1_1ConfigSection.html">net::config::ConfigSection</a></div><div class="ttdef"><b>Definition</b> <a href="ConfigSection_8h_source.html#l00065">ConfigSection.h:65</a></div></div>
<div class="ttc" id="aclassnet_1_1config_1_1ConfigSection_html_afe7a0030f5ef727586a4dc6d32410ce7"><div class="ttname"><a href="classnet_1_1config_1_1ConfigSection.html#afe7a0030f5ef727586a4dc6d32410ce7">net::config::ConfigSection::required</a></div><div class="ttdeci">void required(CLI::Option *opt, bool req=true)</div><div class="ttdef"><b>Definition</b> <a href="ConfigSection_8cpp_source.html#l00082">ConfigSection.cpp:82</a></div></div>
<div class="ttc" id="alegacy_2in_2WebApp_8h_html"><div class="ttname"><a href="legacy_2in_2WebApp_8h.html">WebApp.h</a></div></div>
<div class="ttc" id="anamespaceexpress_1_1legacy_1_1in_html_ae117911fb1d6811868691d20e494b046"><div class="ttname"><a href="namespaceexpress_1_1legacy_1_1in.html#ae117911fb1d6811868691d20e494b046">express::legacy::in::WebApp</a></div><div class="ttdeci">WebAppT&lt; web::http::legacy::in::Server &gt; WebApp</div><div class="ttdef"><b>Definition</b> <a href="legacy_2in_2WebApp_8h_source.html#l00054">WebApp.h:54</a></div></div>
<div class="ttc" id="anamespaceexpress_1_1tls_1_1in_html_a7fcb8097ef9b37166901c5561ccabd8f"><div class="ttname"><a href="namespaceexpress_1_1tls_1_1in.html#a7fcb8097ef9b37166901c5561ccabd8f">express::tls::in::WebApp</a></div><div class="ttdeci">WebAppT&lt; web::http::tls::in::Server &gt; WebApp</div><div class="ttdef"><b>Definition</b> <a href="tls_2in_2WebApp_8h_source.html#l00054">WebApp.h:54</a></div></div>
<div class="ttc" id="atls_2in_2WebApp_8h_html"><div class="ttname"><a href="tls_2in_2WebApp_8h.html">WebApp.h</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="receive-data-via-http-post-request"></a>
Receive Data via HTTP-Post Request</h2>
<p>The high-level web API provides the methods <code>get()</code>, <code>post()</code>, <code>put()</code>, etc like node.js/express.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="legacy_2in_2WebApp_8h.html">express/legacy/in/WebApp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="tls_2in_2WebApp_8h.html">express/tls/in/WebApp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Logger_8h.html">log/Logger.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="configtest_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code hl_function" href="classexpress_1_1WebApp.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a>(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>LegacyWebApp = <a class="code hl_typedef" href="namespaceexpress_1_1legacy_1_1in.html#ae117911fb1d6811868691d20e494b046">express::legacy::in::WebApp</a>;</div>
<div class="line">    <span class="keyword">using </span>LegacySocketAddress = LegacyWebApp::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    LegacyWebApp legacyApp;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The macro </span></div>
<div class="line">    <span class="comment">//    APPLICATION(req, res)</span></div>
<div class="line">    <span class="comment">// expands to </span></div>
<div class="line">    <span class="comment">//    (const std::shared_ptr&lt;express::Request&gt;&amp; (req), const std::shared_ptr&lt;express::Response&gt;&amp; (res))</span></div>
<div class="line">    legacyApp.get(<span class="stringliteral">&quot;/&quot;</span>, [] <a class="code hl_define" href="Router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        res.send(<span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;head&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;style&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            main {&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                min-height: 30em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                padding: 3em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                background-image: repeating-radial-gradient( circle at 0 0, #fff, #ddd 50px);&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            }&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            input[type=\&quot;file\&quot;] {&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                display: block;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                margin: 2em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                padding: 2em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                border: 1px dotted;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            }&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;/style&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;/head&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;h1&gt;File-Upload with input type=\&quot;file\&quot;&lt;/h1&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;main&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            &lt;h2&gt;Send us something fancy!&lt;/h2&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            &lt;form method=\&quot;post\&quot; enctype=\&quot;multipart/form-data\&quot;&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                &lt;label&gt; Select a text file (*.txt, *.html etc.) from your computer.&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                    &lt;input name=\&quot;datei\&quot; type=\&quot;file\&quot; size=\&quot;50\&quot; accept=\&quot;text/*\&quot;&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                &lt;/label&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;                &lt;button&gt;… and off we go!&lt;/button&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;            &lt;/form&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;/main&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;/body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.post(<span class="stringliteral">&quot;/&quot;</span>, [] <a class="code hl_define" href="Router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        res.send(<span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;h1&gt;Thank you, we received your file!&lt;/h1&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;h2&gt;Content:&lt;/h2&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;pre&gt;&quot;</span> +</div>
<div class="line">                 std::string(req-&gt;body.begin(), req-&gt;body.end()) +</div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;/pre&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;/body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.listen(8080, [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: non critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;LegacyWebApp: critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span>TLSWebApp = <a class="code hl_typedef" href="namespaceexpress_1_1tls_1_1in.html#a7fcb8097ef9b37166901c5561ccabd8f">express::tls::in::WebApp</a>;</div>
<div class="line">    <span class="keyword">using </span>TLSSocketAddress = TLSWebApp::SocketAddress;</div>
<div class="line"> </div>
<div class="line">    TLSWebApp tlsApp;</div>
<div class="line"> </div>
<div class="line">    tlsApp.getConfig().setCert(<span class="stringliteral">&quot;&lt;path to X.509 certificate chain&gt;&quot;</span>);</div>
<div class="line">    tlsApp.getConfig().setCertKey(<span class="stringliteral">&quot;&lt;path to X.509 certificate key&gt;&quot;</span>);</div>
<div class="line">    tlsApp.getConfig().setCertKeyPassword(<span class="stringliteral">&quot;&lt;certificate key password&gt;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    tlsApp.use(legacyApp);</div>
<div class="line"> </div>
<div class="line">    tlsApp.listen(8088, [](<span class="keyword">const</span> SocketAddressRc&amp; socketAddress, <span class="keyword">const</span> <a class="code hl_class" href="classcore_1_1socket_1_1State.html">core::socket::State</a>&amp; state) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">switch</span> (state) {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a744e04217104f055ae728e8d884f25de">core::socket::State::OK</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: listening on &#39;&quot;</span> &lt;&lt; socketAddress.toString() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a26b8a9154524cfbba2729255cb184331">core::socket::State::DISABLED</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: disabled&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a3dcc747a68a4c163fcf1c57d9852cab3">core::socket::State::ERROR</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: non critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code hl_variable" href="classcore_1_1socket_1_1State.html#a5d0a9047c96edac9ffd9cd12574328c0">core::socket::State::FATAL</a>:</div>
<div class="line">                VLOG(1) &lt;&lt; <span class="stringliteral">&quot;TLSWebApp: critical error occurred&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classexpress_1_1WebApp.html#a54e6910c9466c61d0b217490b7d9bb5a">express::WebApp::start</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aRouter_8h_html_a8b7131df91fe7a961e2cdadcedb55232"><div class="ttname"><a href="Router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a></div><div class="ttdeci">#define APPLICATION(req, res)</div><div class="ttdef"><b>Definition</b> <a href="Router_8h_source.html#l00067">Router.h:67</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="extract-server-and-client-information-host-name-ip-port-ssltls-information"></a>
Extract Server and Client Information (host name, IP, port, SSL/TLS information)</h2>
<div class="fragment"><div class="line">To be documented soon</div>
</div><!-- fragment --><h2><a class="anchor" id="using-regular-expressions-in-routes"></a>
Using Regular Expressions in Routes</h2>
<div class="fragment"><div class="line">To be documented soon</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 31 2025 11:57:04 for SNode.C by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
