<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1224px" preserveAspectRatio="none" style="width:1408px;height:1224px;" version="1.1" viewBox="0 0 1408 1224" width="1408px" zoomAndPan="magnify"><defs><filter height="300%" id="ftfdi8jlkhi7k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="815.98" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91" y="112.9098"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="58.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="96" y="769.4777"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="165.118" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91" y="960.5957"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="770.2739" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="360" y="144.6158"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="709.5679" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="365" y="184.3218"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="304.0779" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="370" y="555.8118"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="652.8619" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="592" y="221.0278"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="253.6659" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="811" y="252.7338"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="109.8419" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="816" y="319.1459"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="132.5479" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1121.5" y="587.5178"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="119.412" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1250" y="992.3018"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1255" y="1058.7138"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="207.9599" style="stroke: #000000; stroke-width: 2.0;" width="455.5" x="743.5" y="267.7338"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="86.8419" style="stroke: #000000; stroke-width: 2.0;" width="343" x="1054" y="602.5178"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="91.412" style="stroke: #000000; stroke-width: 2.0;" width="171" x="1189" y="1007.3018"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="95.5" x2="95.5" y1="79.2038" y2="1143.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="365" x2="365" y1="79.2038" y2="1143.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="596.5" x2="596.5" y1="79.2038" y2="1143.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="815.5" x2="815.5" y1="79.2038" y2="1143.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1126" x2="1126" y1="375.7138" y2="1143.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1255" x2="1255" y1="665.7917" y2="1143.7138"/><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="27.5" y="41.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="34.5" y="63.1018">SocketConnection</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="27.5" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="34.5" y="1164.6797">SocketConnection</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="309" y="41.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="316" y="63.1018">SocketContext</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="309" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="316" y="1164.6797">SocketContext</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="555.5" y="41.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="562.5" y="63.1018">Response</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="79" x="555.5" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="562.5" y="1164.6797">Response</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="71.2038" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="753.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="767" y="24.9659">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="760.5" y="44.0339">UpgradeFactory</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="787" y="63.1018">Selector</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="71.2038" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="753.5" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="767" y="1164.6797">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="760.5" y="1183.7477">UpgradeFactory</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="787" y="1202.8156">Selector</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="1064" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1077.5" y="1164.6797">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1071" y="1183.7477">UpgradeFactory</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1199" y="1142.7138"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1206" y="1164.6797">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="1223.5" y="1183.7477">Upgrade</text><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="815.98" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91" y="112.9098"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="58.706" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="96" y="769.4777"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="165.118" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="91" y="960.5957"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="770.2739" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="360" y="144.6158"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="709.5679" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="365" y="184.3218"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="304.0779" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="370" y="555.8118"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="652.8619" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="592" y="221.0278"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="253.6659" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="811" y="252.7338"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="109.8419" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="816" y="319.1459"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="132.5479" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1121.5" y="587.5178"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="119.412" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1250" y="992.3018"/><rect fill="#FFFFFF" filter="url(#ftfdi8jlkhi7k)" height="25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1255" y="1058.7138"/><polygon fill="#A80036" points="79,108.9098,89,112.9098,79,116.9098,83,112.9098" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="85" y1="112.9098" y2="112.9098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="10" y="107.1008">readEvent()</text><polygon fill="#A80036" points="348,140.6158,358,144.6158,348,148.6158,352,144.6158" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="101" x2="354" y1="144.6158" y2="144.6158"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="108" y="138.8068">onReceiveFromPeer()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="370" x2="417" y1="171.3218" y2="171.3218"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="417" x2="417" y1="171.3218" y2="184.3218"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="417" y1="184.3218" y2="184.3218"/><polygon fill="#A80036" points="386,180.3218,376,184.3218,386,188.3218,382,184.3218" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="382" y="165.5128">process data</text><polygon fill="#A80036" points="580,217.0278,590,221.0278,580,225.0278,584,221.0278" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="375" x2="586" y1="221.0278" y2="221.0278"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="382" y="215.2188">upgrade(req)</text><polygon fill="#A80036" points="799,248.7338,809,252.7338,799,256.7338,803,252.7338" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="602" x2="805" y1="252.7338" y2="252.7338"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="609" y="246.9248">select(req, *this)</text><path d="M743.5,267.7338 L1048.5,267.7338 L1048.5,276.7338 L1038.5,286.7338 L743.5,286.7338 L743.5,267.7338 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="207.9599" style="stroke: #000000; stroke-width: 2.0;" width="455.5" x="743.5" y="267.7338"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="260" x="758.5" y="282.6308">Activate SocketContextUpgradeFactory</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="821" x2="868" y1="306.1459" y2="306.1459"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="868" x2="868" y1="306.1459" y2="319.1459"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="827" x2="868" y1="319.1459" y2="319.1459"/><polygon fill="#A80036" points="837,315.1459,827,319.1459,837,323.1459,833,319.1459" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="833" y="300.3369">select(upgradeContextName)</text><polygon fill="#A80036" points="1052,351.8519,1062,355.8519,1052,359.8519,1056,355.8519" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="826" x2="1058" y1="355.8519" y2="355.8519"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="833" y="350.0429">getSocketContextUpgradeFactory()</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="1064" y="332.1459"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1077.5" y="354.1118">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1071" y="373.1797">UpgradeFactory</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="826" x2="868" y1="427.9877" y2="427.9877"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="868" x2="868" y1="427.9877" y2="440.9877"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="821" x2="868" y1="440.9877" y2="440.9877"/><polygon fill="#A80036" points="831,436.9877,821,440.9877,831,444.9877,827,440.9877" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="833" y="422.1787">socketContextUpgradeFactory</text><polygon fill="#A80036" points="1114.5,463.6937,1124.5,467.6937,1114.5,471.6937,1118.5,467.6937" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="821" x2="1120.5" y1="467.6937" y2="467.6937"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="828" y="461.8847">prepare(req, res)</text><polygon fill="#A80036" points="613,502.3997,603,506.3997,613,510.3997,609,506.3997" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="607" x2="815" y1="506.3997" y2="506.3997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="619" y="500.5907">socketContextUpgradeFactory</text><polygon fill="#A80036" points="391,551.8118,381,555.8118,391,559.8118,387,555.8118" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="385" x2="591" y1="555.8118" y2="555.8118"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="397" y="532.2968">switchSocketContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="397" y="550.0028">(socketContextUpgradeFactory)</text><polygon fill="#A80036" points="1109.5,583.5178,1119.5,587.5178,1109.5,591.5178,1113.5,587.5178" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="380" x2="1115.5" y1="587.5178" y2="587.5178"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="387" y="581.7088">create</text><path d="M1054,602.5178 L1392,602.5178 L1392,611.5178 L1382,621.5178 L1054,621.5178 L1054,602.5178 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="86.8419" style="stroke: #000000; stroke-width: 2.0;" width="343" x="1054" y="602.5178"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="293" x="1069" y="617.4148">Prepare and create a SocketContextUpgrade</text><polygon fill="#A80036" points="1187,641.9298,1197,645.9298,1187,649.9298,1191,645.9298" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1131.5" x2="1193" y1="645.9298" y2="645.9298"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="1138.5" y="640.1208">create</text><rect fill="#FEFECE" filter="url(#ftfdi8jlkhi7k)" height="52.1358" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1199" y="622.2238"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1206" y="644.1898">SocketContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="1223.5" y="663.2577">Upgrade</text><polygon fill="#A80036" points="391,716.0657,381,720.0657,391,724.0657,387,720.0657" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="385" x2="1125.5" y1="720.0657" y2="720.0657"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="397" y="714.2567">socketContextUpgrade</text><polygon fill="#A80036" points="117,765.4777,107,769.4777,117,773.4777,113,769.4777" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="369" y1="769.4777" y2="769.4777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="123" y="745.9627">switchSocketContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="123" y="763.6687">(socketContextUpgradeFactory)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="106" x2="148" y1="801.1837" y2="801.1837"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="148" x2="148" y1="801.1837" y2="814.1837"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="107" x2="148" y1="814.1837" y2="814.1837"/><polygon fill="#A80036" points="117,810.1837,107,814.1837,117,818.1837,113,814.1837" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="113" y="795.3747">socketContext = socketContextUpgrade</text><polygon fill="#A80036" points="358,824.1837,368,828.1837,358,832.1837,362,828.1837" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="101" x2="364" y1="828.1837" y2="828.1837"/><polygon fill="#A80036" points="580,855.8897,590,859.8897,580,863.8897,584,859.8897" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="375" x2="586" y1="859.8897" y2="859.8897"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="382" y="854.0807">socketContextUpgrade</text><polygon fill="#A80036" points="386,869.8897,376,873.8897,386,877.8897,382,873.8897" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="380" x2="596" y1="873.8897" y2="873.8897"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="375" x2="417" y1="892.8897" y2="892.8897"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="417" x2="417" y1="892.8897" y2="905.8897"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="370" x2="417" y1="905.8897" y2="905.8897"/><polygon fill="#A80036" points="380,901.8897,370,905.8897,380,909.8897,376,905.8897" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="112,910.8897,102,914.8897,112,918.8897,108,914.8897" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="106" x2="364" y1="914.8897" y2="914.8897"/><polygon fill="#A80036" points="14,924.8897,4,928.8897,14,932.8897,10,928.8897" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="8" x2="95" y1="928.8897" y2="928.8897"/><polygon fill="#A80036" points="79,956.5957,89,960.5957,79,964.5957,83,960.5957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="85" y1="960.5957" y2="960.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="10" y="954.7867">readEvent()</text><polygon fill="#A80036" points="1238,988.3018,1248,992.3018,1238,996.3018,1242,992.3018" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="101" x2="1244" y1="992.3018" y2="992.3018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="108" y="986.4928">onReceiveFromPeer()</text><path d="M1189,1007.3018 L1316,1007.3018 L1316,1016.3018 L1306,1026.3018 L1189,1026.3018 L1189,1007.3018 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="91.412" style="stroke: #000000; stroke-width: 2.0;" width="171" x="1189" y="1007.3018"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="1204" y="1022.1988">Process data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1260" x2="1307" y1="1045.7138" y2="1045.7138"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307" x2="1307" y1="1045.7138" y2="1058.7138"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1266" x2="1307" y1="1058.7138" y2="1058.7138"/><polygon fill="#A80036" points="1276,1054.7138,1266,1058.7138,1276,1062.7138,1272,1058.7138" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1272" y="1039.9048">process data</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1265" x2="1307" y1="1082.7138" y2="1082.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1307" x2="1307" y1="1082.7138" y2="1095.7138"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1260" x2="1307" y1="1095.7138" y2="1095.7138"/><polygon fill="#A80036" points="1270,1091.7138,1260,1095.7138,1270,1099.7138,1266,1095.7138" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="112,1107.7138,102,1111.7138,112,1115.7138,108,1111.7138" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="106" x2="1254" y1="1111.7138" y2="1111.7138"/><polygon fill="#A80036" points="14,1121.7138,4,1125.7138,14,1129.7138,10,1125.7138" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="8" x2="95" y1="1125.7138" y2="1125.7138"/><!--MD5=[9b9659a08295f81fc5d0fc3b4c6ef8b6]
@startuml inline_umlgraph_7.svg
skinparam handwritten false
participant "SocketConnection" as scn
participant "SocketContext" as sc
participant "Response" as res
participant "SocketContext\nUpgradeFactory\nSelector" as scufs

-> scn ++ : readEvent()
  scn -> sc ++ : onReceiveFromPeer()
    sc -> sc ++ : process data
      sc -> res ++ : upgrade(req)
        res -> scufs ++ : select(req, *this)
          group Activate SocketContextUpgradeFactory
            scufs -> scufs ++ : select(upgradeContextName)
              scufs -> "SocketContext\nUpgradeFactory" as scuf ** : getSocketContextUpgradeFactory()
            return socketContextUpgradeFactory
            scufs -> scuf : prepare(req, res)
          end
        return socketContextUpgradeFactory
        res -> sc ++ : switchSocketContext\n(socketContextUpgradeFactory)
          sc -> scuf ++ : create
            group Prepare and create a SocketContextUpgrade
              scuf -> "SocketContext\nUpgrade" as scu ** : create
            end
          return socketContextUpgrade
          sc -> scn ++ : switchSocketContext\n(socketContextUpgradeFactory)
            scn -> scn : socketContext = socketContextUpgrade
          return
        return socketContextUpgrade
      return
    return
  return
return
-> scn ++ : readEvent()
  scn -> scu ++ : onReceiveFromPeer()
    group Process data
      scu -> scu ++ : process data
      return
    end
  return
return
@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.10+7-Debian-1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>